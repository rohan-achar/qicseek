<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="GENERATOR" CONTENT="Globetrotter 1.1.1" />
<META HTTP-EQUIV="AUTHOR" CONTENT="David G. Kay" />
<META HTTP-EQUIV="UPDATED" CONTENT="Wednesday, November 2, 2005 12:58 PM" />
<TITLE>Lab Assignment 6</TITLE>
<META HTTP-EQUIV="X-GLOBETROTTERDATA" CONTENT="D23C3977" />
<META HTTP-EQUIV=KEYWORDS CONTENT="CS 1, CS1, assignment, Scheme" />
<META HTTP-EQUIV="DESCRIPTION" CONTENT="An assignment for ICS H21, an honors first-quarter course in computer science in Information and Computer Science, UC Irvine, using How to Design Programs by Matthias Felleisen et al." />
<META HTTP-EQUIV="COPYRIGHT" CONTENT="Copyright &#169; 2001-2004 by David G. Kay.  All rights reserved." />
<link href="/~kay/courses/h21/code.css" rel="stylesheet" type="text/css" />
<style type="text/css">
<!--
.style1 {
	font-family: "Courier New", Courier, monospace;
	font-size: 10pt;
}
.style2 {font-size: 10pt}
.style3 {font-family: "Courier New", Courier, monospace}
.style31 {	font-family: "Courier New", Courier, monospace;
	font-size: 10pt;
}
-->
</style>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<P><font size="2" face="Garamond">ICS H21 &bull; UC IRVINE &bull; DAVID G. KAY &bull; FALL 2009</font></P>
<P><FONT FACE="Garamond" SIZE=6><B>Lab Assignment 6 </B></FONT></P>
<P><FONT FACE="Garamond" SIZE=4>This assignment is due at the end of lab on
  Friday, November 6. </FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4>Choose a partner for this assignment, someone
you haven&#39;t worked with already.  Be sure your language level is set
 to Intermediate Student with Lambda.</FONT></P>
<P><FONT FACE="Garamond" SIZE=4><B>(a)</B> Do exercises 19.1.4, 19.1.5, 19.1.6, and 19.2.2.</FONT></P>
<P> <FONT FACE="Garamond" SIZE=4><B>(b)</B> Suppose we change our restaurant
    structure so that instead of just one best dish and its price, each restaurant
has a menu of dishes.  So a </FONT><span class="style2"><FONT FACE="Courier New">rrant</FONT></span><FONT FACE="Garamond" SIZE=4> is now</FONT></P>
<P> <span class="style31">&#160;&#160; (make-rrant
  name cuisine phone menu)</span></P>
<P> <FONT FACE="Garamond" SIZE=4>where </FONT><span class="style2"><FONT FACE="Courier New">name</FONT></span><FONT FACE="Garamond" SIZE=4>, </FONT><span class="style2"><FONT FACE="Courier New">cuisine</FONT></span><FONT FACE="Garamond" SIZE=4>,
  and </FONT><span class="style2"><FONT FACE="Courier New">phone</FONT></span><FONT FACE="Garamond" SIZE=4> are strings and </FONT><span class="style2"><FONT FACE="Courier New">menu</FONT></span><FONT FACE="Garamond" SIZE=4> is a list of dish structures:</FONT></P>
<P><FONT FACE="Courier New"><span class="style31">&#160;&#160; </span><span class="style2">(make-dish
  name price)</span></FONT></P>
<P> <FONT FACE="Garamond" SIZE=4>where </FONT><span class="style2"><FONT FACE="Courier New">name</FONT></span><FONT FACE="Garamond" SIZE=4> is a string and </FONT><span class="style2"><FONT FACE="Courier New">price</FONT></span><FONT FACE="Garamond" SIZE=4> is a number.</FONT></P>
<P><FONT FACE="Garamond" SIZE=4>None of these modifications should require any
  change to the code for collections.</FONT></P>
<P> <FONT FACE="Garamond" SIZE=4><B>(b.1)</B> Make up a big list of </FONT><span class="style2"><FONT FACE="Courier New">rrant</FONT></span><FONT FACE="Garamond" SIZE=4> structures to use in your testing.  Trade and combine lists with your classmates.</FONT></P>
<P> <FONT FACE="Garamond" SIZE=4><B>(b.2)</B> Download </FONT><FONT FACE="Garamond"><a href="http://www.ics.uci.edu/~kay/scheme/restaurants1d.scm">version 1d</a></FONT><FONT FACE="Garamond" SIZE=4> of the restaurants program. Spend some time studying it; it's a version that includes the erase and adjust commands, plus binary search trees using lazy deletion.</FONT></P>
<P><FONT FACE="Garamond" SIZE=4>Make a copy of the restaurants1d.scm
  program and call it restaurants1e.scm.</FONT></P>
<P> <FONT FACE="Garamond" SIZE=4><B>(b.3)</B> Modify the program to handle </FONT><span class="style2"><FONT FACE="Courier New">rrant</FONT></span><FONT FACE="Garamond" SIZE=4> objects that include menus as described above.  You should try at least to make a list of all
  the changes you will need before looking at <A HREF="http://www.ics.uci.edu/~kay/courses/h21/hw/hw5menus.html">our checklist</A> of modification steps.</FONT></P>
<P> <FONT FACE="Garamond" SIZE=4><B>(b.4)</B> Modify the program to display
  the average price (of all the dishes on the menu) whenever a restaurant
  is printed.</FONT></P>
<P> <FONT FACE="Garamond" SIZE=4><B>(b.5)</B> Add a command to the main menu
  that allows the user to search for (and display) all the restaurants that
  serve a given cuisine along with the average price of (all the menus of
  the restaurants that serve) that cuisine.</FONT></P>
<P> <FONT FACE="Garamond" SIZE=4><B>(b.6)</B> Add a command to the main menu
  that allows the user to search for (and display) all the restaurants that
  serve a dish containing a given word or phrase.  (This is more realistic
  than forcing the user to type the exact name of the dish; here, the user
  can just type &quot;fava beans&quot; and match all the dishes that include
  that phrase.  We&#39;ve provided some <A HREF="http://www.ics.uci.edu/~kay/scheme/strings.scm">code for string processing</A> to make this task easier.)</FONT><FONT FACE="Goudy Old Style"> </FONT></P>
<P> <FONT FACE="Garamond" SIZE=4>Collect all of these definitions and submit
  them via Checkmate.</FONT></P>
<P><FONT FACE="Garamond" SIZE=4><B>(c)</B>  At the end of the Functions as
First-Class Objects sheet, we refactored the functions </FONT><span class="style1">find-all-matches
</span><span class="style2"></span><FONT FACE="Garamond" SIZE=4>and </FONT><FONT FACE="Courier New" class="style1">remove-all-matches</FONT><FONT FACE="Garamond" SIZE=4>,
defining both in terms of a more general </FONT><FONT FACE="Courier New" class="style1">handle-all-matches</FONT><FONT FACE="Garamond" SIZE=4>.</FONT></P>
<P>
  <FONT FACE="Garamond" SIZE=4><B>(c.1)</B>  Do the same thing in the second
  restaurants program (available at </FONT><FONT FACE="Courier New"><A HREF="http://www.ics.uci.edu/~kay/scheme/restaurants2.scm" class="style1">http://www.ics.uci.edu/~kay/scheme/restaurants2.scm</A></FONT><FONT FACE="Garamond" SIZE=4>)
      with </FONT><FONT FACE="Courier New" class="style1">collection-search</FONT><FONT FACE="Garamond" SIZE=4>
      and </FONT><FONT FACE="Courier New" class="style1">collection-remove</FONT><FONT FACE="Garamond" SIZE=4>,
          redefining both in terms of a general </FONT><FONT FACE="Courier New" class="style1">collection-check</FONT><FONT FACE="Garamond" SIZE=4>
function.</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4><B>(c.2)</B>  (extra credit, but the next part's required) Now redefine </FONT><FONT FACE="Courier New" class="style1">collection-check</FONT><FONT FACE="Garamond" SIZE=4>
and </FONT><FONT FACE="Courier New" class="style1">collection-change</FONT><FONT FACE="Garamond" SIZE=4>
in terms of a still-more-general </FONT><FONT FACE="Courier New" class="style1">collection-process</FONT><FONT FACE="Garamond" SIZE=4>
function.</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4><B>(c.3)</B>  Simplify your definition of </FONT><FONT FACE="Courier New" class="style1">collection-process</FONT><FONT FACE="Garamond" SIZE=4>
(or </FONT><FONT FACE="Courier New" class="style1">collection-check</FONT><FONT FACE="Garamond" SIZE=4>
and </FONT><FONT FACE="Courier New" class="style1">collection-change</FONT><FONT FACE="Garamond" SIZE=4>)
using </FONT><FONT FACE="Courier New" class="style1">map</FONT><FONT FACE="Garamond" SIZE=4>,
</FONT><FONT FACE="Courier New" class="style1">filter</FONT><FONT FACE="Garamond" SIZE=4>,
</FONT><FONT FACE="Courier New" class="style1">foldr</FONT><FONT FACE="Garamond" SIZE=4>,
and similar functions.</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4>Collect all of these definitions and submit
them via Checkmate.</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4><B>(d)</B> Be sure you've read the section in
Homework 6 about files;
now it&#39;s time to write a few file-handling functions.  Download and
install the simple-file-io.ss teachpack at </FONT><FONT FACE="Courier New"><A HREF="http://www.ics.uci.edu/~kay/scheme/simple-file-io.ss"><code>http://www.ics.uci.edu/~kay/scheme/simple-file-io.ss</code></A></FONT><FONT FACE="Garamond" SIZE=4>.
(Remember to right- or control-click on the link and download the file, saving it in the same folder that contains your code.) We also have some <A HREF="http://www.ics.uci.edu/~kay/scheme/text-file-io.scm">file-handling code</A> that provides four functions for reading and writing text files:<A NAME="_14_11380"></A></FONT></P>
<P><code>;; file-&gt;list: string -&gt; list<br />
;; Given a string naming a file, read the file into a list of strings.</code></P>
<p><code>;; file-dialog-&gt;list: anything -&gt; list<br />
  ;; Show user a dialog box to choose a file; read the file into a list of strings<br />
  ;; Call with (file-dialog-&gt;list 'x) because student Schemes don't allow<br />
  ;; parameterless functions.</code></p>
<p><code>;; list-&gt;file: string list -&gt; side effects (a new file)<br />
  ;; Given a string naming a new file, write list of strings that file, <br />
  ;; one string per line.</code></p>
<p><code>;; list-&gt;file-dialog: list -&gt; side effects (a new file)<br />
  ;; Write a list of strings to a new file <br />
  ;; (chosen by showing the user a file selection dialog)</code></p>
<P>
<FONT FACE="Garamond" SIZE=4>These functions operate on text files
with the extension &quot;.txt&quot; or other files that consist only of
characters you can type on the keyboard.  Word documents don&#39;t work
unless they&#39;re saved as plain text; Scheme files <em>do</em> work unless they&#39;re
saved with comment boxes, images, or other special features.</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4><B>(d.1)</B>  Define the function <CODE>copy-file</CODE>
that takes two strings&mdash;the name of an existing file and the name of a new
file&mdash;and copies the contents of one to the other.  Use</FONT><FONT FACE="Courier New" SIZE=2>
</FONT><FONT FACE="Courier New" class="style1">file-&gt;list</FONT><FONT FACE="Garamond" SIZE=4>
and </FONT><FONT FACE="Courier New" class="style1">list-&gt;file</FONT><FONT FACE="Garamond" SIZE=4>.
 Test it out with a short file.  Then download the Project Gutenberg version
of <I>The Adventures of Sherlock Holmes</I> from </FONT><FONT FACE="Courier New"><A HREF="http://www.gutenberg.org/dirs/etext99/advsh12.txt" class="style1">http://www.gutenberg.org/dirs/etext99/advsh12.txt</A></FONT><FONT FACE="Garamond" SIZE=4>.
 (Project Gutenberg is a wonderful resource for non-copyright-protected
texts).  If you have to work on a slow network connection, you may pick
a smaller file; this one is 577K.  Use your copy-file program to make another
copy of this file.</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4><B>(d.2)</B>  Write the function <span class="style1">copy-file-dialog</span> that takes one parameter (that it ignores&mdash;parameterless functions aren&#39;t
allowed in the DrScheme student languages), displays a dialog box for the
user to select a file to copy, displays another dialog box for the user
to select the name of the copied file, and then creates the copy.  Use <span class="style1">file-dialog-&gt;list</span> and <span class="style1">list-&gt;file-dialog</span>.  Test this function with a couple of files.  (Testing
of these file-handling programs isn&#39;t quite as convenient as just putting
examples into your code, but it is essential nonetheless.  This is just
an illustration of how interactive programs add an extra layer of complexity
to the computing task.)</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4><B>(d.3)</B>  Write the function <span class="style1">copy-with-line-numbers</span> that behaves like <span class="style1">copy-file</span>, except that the copied file has line numbers
in this form<A NAME="_14_13770"></A></FONT></P>
<P><code>1: The Project Gutenberg EBook of The Adventures of Sherlock Holmes<br />
  2: by Sir Arthur Conan Doyle<br />
  3: (#15 in our series by Sir Arthur Conan Doyle)<br />
  4:<br />
&nbsp;&nbsp; ...<br />
13014: *END THE SMALL PRINT! FOR PUBLIC DOMAIN EBOOKS*Ver.02/11/02*END*</code></P>
<P>
<FONT FACE="Garamond" SIZE=4>The pre-defined functions <span class="style1">string-append</span> and <span class="style1">number-&gt;string</span> may be helpful.</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4><B>(d.4)</B>  (optional, but there are required
parts further down)  You&#39;ll notice that in your line-numbered file,
the lines don&#39;t line up neatly because the numbers have different lengths.
 It would be nice to be able to display a number in a five-character field,
so that <span class="style1">17</span> would display as &quot;</FONT><FONT SIZE=4><span class="style3">&nbsp;&nbsp;&nbsp;</span></FONT><FONT FACE="Garamond" SIZE=4><span class="style1">17</span>&quot; (with three spaces before
the number).</FONT></P>
<P><code>;; pad5: string -&gt; string<br />
  ;; If input string is 5 characters or longer, return it unchanged. Otherwise, <br />
;; add enough blanks at the left of the string to make it 5 characters long.</code></P>
<P><FONT FACE="Garamond" SIZE=4>Use this function in your line-numbering program;
  the pre-defined function <span class="style1">string-length</span>
  will be useful here.</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4>Next, write a generalized version of the function:</FONT></P>
<P><code>;; pad: string number symbol string -&gt; string<br />
  ;; The first argument is the input string. The second is the desired length.<br />
  ;; The third, 'left or 'right, indicates which end of the string should be padded.<br />
  ;; The fourth is the string that should be added repeatedly <br />
  ;; until the string is at least as long as the desired length.<br />
  ;; Examples: (pad &quot;Hi&quot; 5 'right &quot;!&quot;) -&gt; &quot;Hi!!!&quot;<br />
;; (pad &quot;Preface&quot; 12 'right &quot;_.&quot;) -&gt; &quot;Preface_._._.&quot;</code></P>
<P>
<FONT FACE="Garamond" SIZE=4>Finally, use these functions in your line-numbering
program so that the numbers are printed in five-character fields (except
for numbers over 99,999, which should be as long as necessary).</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4><B>(d.5)</B>  Starting with a copy of your
<span class="style1">copy-file</span> function (without the line numbers), write the function <span class="style1">pick</span>,
which takes three arguments.  The first should be a string that the function
will search for in the file; the second is a string naming the input file;
the third is a string naming the output file.  The output file should contain
only those lines in the input file that contain the specified string somewhere
in the line.  (The string-processing functions from the previous assignment
should be useful here.)</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4><B>(d.6)</B>  Define the function <span class="style1">stats</span>, which
takes a string naming a file and a symbol that indicates what statistic
to compute (and return) about the file, according to the list below.  You
should try to use local definitions in your function so that you don&#39;t
calculate intermediate results more than once.  You&#39;ll want to use the
predefined function <span class="style1">string-length</span>.  You can also use <span class="style1">map</span>, <span class="style1">filter</span>, and <span class="style1">foldr</span> to calculate these values compactly.</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4>&#160;&#160;</FONT><FONT FACE="Courier New" class="style1">&#39;total-lines</FONT><FONT FACE="Garamond" SIZE=4>:
 The total number of lines in the file</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4>&#160;&#160;</FONT><FONT FACE="Courier New" class="style1">&#39;average-length</FONT><FONT FACE="Garamond" SIZE=4>:
 The average length of lines in the file</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4>&#160;&#160;</FONT><FONT FACE="Courier New" class="style1">&#39;empty-lines</FONT><FONT FACE="Garamond" SIZE=4>:
 The number of empty (zero-length) lines in the file</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4>&#160;&#160;</FONT><FONT FACE="Courier New" class="style1">&#39;average-nonempty-length</FONT><FONT FACE="Garamond" SIZE=4>:
 The average length of the non-empty lines in the file</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4>&#160;&#160;</FONT><FONT FACE="Courier New" class="style1">&#39;longest-line</FONT><FONT FACE="Garamond" SIZE=4>:
 The longest line in the file (you can do this with foldr)</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4>&#160;&#160;</FONT><FONT FACE="Courier New" class="style1">&#39;longest-line-length</FONT><FONT FACE="Garamond" SIZE=4>:
 The length of the longest line in the file</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4>&#160;&#160;</FONT><FONT FACE="Courier New" class="style1">&#39;shortest-line</FONT><FONT FACE="Garamond" SIZE=4>:
 The shortest non-empty line in the file</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4>&#160;&#160;</FONT><FONT FACE="Courier New" class="style1">&#39;shortest-line-length</FONT><FONT FACE="Garamond" SIZE=4>:
 The length of the shortest line in the file.</FONT></P>
<P>
<FONT FACE="Garamond" SIZE=4>Submit these definitions via Checkmate.</FONT></P>
<P><FONT FACE="Garamond" SIZE=4><B>(e)</B>
    <!-- REMOVED, AS THEY USE DRAW.SS INSTEAD OF IMAGE.SS
     Do exercises 21.4.1, 21.4.2, 21.4.3, 21.4.4, and 21.4.5. -->
Do exercises 21.2.1, 21.2.2, and 21.2.3.</FONT></P>
<P> <FONT FACE="Garamond" SIZE=4>Collect these definitions and submit them
  as usual via Checkmate.</FONT></P>
<P><FONT FACE="Garamond" SIZE=4><B>(f)</B> For extra credit, try to refine the </FONT><FONT FACE="Courier New">evaluate</FONT><FONT FACE="Garamond" SIZE=4> function from section 14.4 to handle all-numeric expressions (as before)
  and also expressions with one variable.  You&#39;d start with </FONT><FONT FACE="Courier New">(define
    evaluate (lambda (exp var num) ...)</FONT><FONT FACE="Garamond" SIZE=4>,
      which returns the value of </FONT><FONT FACE="Courier New">exp</FONT><FONT FACE="Garamond" SIZE=4> (with </FONT><FONT FACE="Courier New">num</FONT><FONT FACE="Garamond" SIZE=4> substituted for each occurrence of </FONT><FONT FACE="Courier New">var</FONT><FONT FACE="Garamond" SIZE=4>).
        Refine </FONT><FONT FACE="Courier New">evaluate</FONT><FONT FACE="Garamond" SIZE=4> further to take a list of variable-value pairs and substitute all the values
          for their respective variables.</FONT></P>
<P><FONT FACE="Garamond" SIZE=4><B>(g)</B>  Remember that each partner must
complete a partner evaluation form via the Survey tool on eee.uci.edu.  <!--A
few students have not been doing this consistently; if you have missed any
forms, go back and do them now (and let the TA know, so he will pick them
up and record them).  Missing evaluation forms (on any assignment
from the start of the quarter) or late evaluation forms (starting now) will
lower your score on an assignment.-->
</FONT></P>
<BR />
<P>
<FONT FACE="Helvetica" SIZE=1>Based in part on ICS H21assignments and exams
by David G. Kay from Fall 2001; modified by David G. Kay with material from
Informatics 41, Fall 2004 and Fall 2005; file I/O code written by Angelo
Pioli, Fall 2005. Modified by David G. Kay, Fall 2009.</FONT></P>
<HR />
<FONT FACE="Garamond"><A HREF="http://www.ics.uci.edu/~kay/">David G. Kay</A>, <a href=mailto:kay@uci.edu>kay@uci.edu</A> </FONT><span><br />
<font size="2" face="Garamond">
<!-- #BeginDate format:fcAm1a -->Saturday, October 31, 2009 3:16 PM<!-- #EndDate -->
</font></span></BODY>
</HTML>
