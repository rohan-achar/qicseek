<HTML>
<HEAD>
<BASE TARGET="_top">
<TITLE>United States Patent: 5,526,281</TITLE></HEAD>
<BODY BGCOLOR="#FFFFFF">
<a name="top"></a>
<center>
<IMG SRC="rickl-patent-patfthdr.gif">
</center>  
<p>
<TABLE border=0>
<TR><TD VALIGN=TOP ALIGN=LEFT width=40>
&nbsp;
</TD>
<TD VALIGN=TOP ALIGN=LEFT width=40>
&nbsp;
</TD>
<TD VALIGN=TOP ALIGN=RIGHT WIDTH=50>
</TD><TD ALIGN=RIGHT VALIGN=BOTTOM WIDTH=500><FONT SIZE=-1>( <STRONG>1</STRONG></FONT> <FONT SIZE=-2>of</FONT> <STRONG><FONT SIZE=-1>1</STRONG> )</FONT></TD></TR></TABLE>
<HR>
<TABLE WIDTH="100%">
<TR>	<TD ALIGN="LEFT" WIDTH="50%"><B>United States Patent </B></TD>
	<TD ALIGN="RIGHT" WIDTH="50%"><B> <A Name=h2 HREF=#h1></A><A  HREF=#h3></A><B><I>5,526,281</I></B>
</B></TD>
</TR>
<TR><TD ALIGN="LEFT" WIDTH="50%"><b>
Chapman
, &nbsp et al.</B>
</TD><TD ALIGN="RIGHT" WIDTH="50%"> <B>
June 11, 1996
</B></TD>
</TR>
</TABLE><HR>
<font size="+1"> Machine-learning approach to modeling biological activity for molecular
     design and to modeling other characteristics
</font><BR>
<BR><CENTER><B>Abstract</B></CENTER>
<P>Explicit representation of molecular shape of molecules is combined with
     neural network learning methods to provide models with high predictive
     ability that generalize to different chemical classes where structurally
     diverse molecules exhibiting similar surface characteristics are treated
     as similar. A new machine-learning methodology that can accept multiple
     representations of objects and construct models that predict
     characteristics of those objects. An extension of this methodology can be
     applied in cases where the representations of the objects are determined
     by a set of adjustable parameters. An iterative process applies
     intermediate models to generate new representations of the objects by
     adjusting said parameters and repeatedly retrains the models to obtain
     better predictive models. This method can be applied to molecules because
     each molecule can have many orientations and conformations
     (representations) that are determined by a set of translation, rotation
     and torsion angle parameters.
</P>
<HR>
  <TABLE WIDTH="100%">
  <TR><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%">Inventors:
  </TD><TD ALIGN="LEFT" WIDTH="90%">
  <B>Chapman; David</B> (San Francisco, CA);
<B>Critchlow; Roger</B> (San Francisco, CA);
<B>Jain; Ajay N.</B> (San Carlos, CA);
<B>Lathrop; Rick</B> (Cambridge, MA);
<B>Perez; Tomas L.</B> (Cambridge, MA);
<B>Dietterich; Tom</B> (Corvalis, OR)
  </TD></TR>
  <TR><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%">Assignee:
  </TD><TD ALIGN="LEFT" WIDTH="90%">
  <B>Arris Pharmaceutical Corporation</B> (South San Francisco, CA)
  </TD></TR>
<TR><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%" NOWRAP>Appl. No.:
</TD><TD ALIGN="LEFT" WIDTH="90%">                    
<B> 382990</B></TD></TR>
  <TR><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%">Filed:
  </TD><TD ALIGN="LEFT" WIDTH="90%">                    
  <B>October 28, 1994</B></TD></TR>
</TABLE>
<p>
<TABLE WIDTH="100%">
  <TR><TD VALIGN=TOP ALIGN="LEFT" WIDTH="40%"><B>U.S. Class:</B></TD>
  <TD VALIGN=TOP ALIGN="RIGHT" WIDTH="60%"><B>364/496</B>; 364/578; 395/920  </TD></TR>
  <TR><TD VALIGN=TOP ALIGN="LEFT" WIDTH="40%"><B>Intern'l Class: </B></TD>
  <TD VALIGN=TOP ALIGN="RIGHT" WIDTH="60%">G06F 017/00; G06F 015/18</TD></TR>
  <TR><TD VALIGN=TOP ALIGN="LEFT" WIDTH="40%"><B>Field of Search: </B></TD>
  <TD ALIGN="RIGHT" VALIGN="TOP" WIDTH="60%">
  364/496,497,578
395/920,924,21,22,23
  </TD></TR>
</TABLE>
<HR><CENTER><B>References Cited   </B></CENTER><HR>
<CENTER><B>U.S. Patent Documents</B></CENTER>
<TABLE WIDTH="100%"><TR><TD WIDTH="25%">5025388</TD><TD WIDTH="25%">Jun., 1991</TD><TD WIDTH="25%" ALIGN="LEFT">Cramer, III et al.</TD><TD WIDTH="25%" ALIGN="RIGHT">364/496.
</TD></TR>
<TR><TD WIDTH="25%">5167009</TD><TD WIDTH="25%">Nov., 1992</TD><TD WIDTH="25%" ALIGN="LEFT">Skeririk</TD><TD WIDTH="25%" ALIGN="RIGHT">395/27.
</TD></TR>
<TR><TD WIDTH="25%">5260882</TD><TD WIDTH="25%">Nov., 1993</TD><TD WIDTH="25%" ALIGN="LEFT">Blanco et al.</TD><TD WIDTH="25%" ALIGN="RIGHT">364/499.
</TD></TR>
<TR><TD WIDTH="25%">5265030</TD><TD WIDTH="25%">Nov., 1993</TD><TD WIDTH="25%" ALIGN="LEFT">Skolnick et al.</TD><TD WIDTH="25%" ALIGN="RIGHT">364/496.
</TD></TR>
</TABLE>

<BR>
  <TABLE WIDTH="90%">
  <BR>
  <CENTER><B>Other References</B></CENTER>
  <TD ALIGN=LEFT><br>T. A. Andrea, et al., Applications of Neural Networks in Quantitative
     Structure-Activity Relationship of Dihydrofolate Reductase Inhibitors,
     Journal of Medicinal Chemistry, vol. 34, No, 9, 1991, pp. 2824-2836.
<br>Good, et al., Structure-Activity Relationships from Molecular Similarity
     Matrices, Journal of Medicinal Chemistry, vol. 36, No. 4, Feb. 19, 1993,
     pp. 433-438.
<br>Aoyama, et al., Neural Networks Applied to Quantitative Structure-Activity
     Relationship Analysis, Journal of Medicinal Chemistry, 1990, vol. 33, No.
     9, pp. 2583-2590.
<br>Aoyama, et al., Obtaining the Correlation Indices Between Drug Activity and
     Structural Parameters Using a Neural Network, Chemical Pharmaceutical
     Bulletin, vol. 39, No. 2, pp. 372-378, 1991.
<br>Oinuma, et al., Neural Networks Applied to Structure-Activity
     Relationships, Journal of Medicinal Chemistry, vol. 33, No. 3, 1990, pp.
     905-908.
<br>Viswanadhan, et al., Mapping the Binding Site of the Nucleoside Transporter
     Protein: A 3D-QSAR Study, Biochemica et Biophysica Acta., 1039 (1990)
     356-366.
<br>Ghose, et al., Use of Physicochemical Parameters in Distance Geometry and
     Related Three-Dimensional Quantitative Structure-Activity Relationships: A
     Demonstration Using Escherichia coli Dihydrofolate Reductase Inhibitors,
     Journal of Medical Chemistry, vol. 28, No. 3, 1985, pp. 333-346.
<br>Smellie, et al., Fast Drug-Receptor Mapping by Site-Directed Distances: A
     Novel Method of Predicting New Pharmacological Leads, J. Chem. Inf.
     Comput. Sci., vol. 31, No. 3, 1991, pp. 386-392.
<br>Cramer, III, et al., Comparative Molecular Field Analysis (COMFA), J. Am.
     Chem. Soc., vol. 110, No. 18, 1988, pp. 5959-5967.
<br>Crippen, et al., Distance Geometry and Molecular Conformation, Research
     Studies Press Ltd., 8, Ligand Binding, pp. 361-429.
<br>Hopfinger, A QSAR Investigation of Dihydrofolate Reductase Inhibition By
     Baker Triazines Based Upon Molecular Shape Analysis, J. Am. Chem. Soc.,
     1980, 102, 7196-7206.
<br>Doweyko, The Hypothetical Active Site Lattice. An Approach to Modelling
     Active Sites from Data on Inhibitor Molecules, Journal of American
     Chemistry, 1988, 31 (7), pp. 1396-1406.
<br>Simon, et al., Mapping of Dihydrofolate-Reductase Receptor Site by
     Correlation with Minimal Topological (Steric) Differences, J. Theor.
     Biol., 1977, 66, pp. 485-495.
<br>Crippen, Deduction of Binding Site Structure from Ligand Binding Data,
     Annals New York Academy of Sciences, vol. 439, 1984, pp. 1-11.
<br>Boulu, et al., Voronoi Binding Site Models: Calculation of Binding Modes
     and Influence of Drug Binding Data Accuracy, Journal of Computational
     Chemistry, 10 (5), 673-632 (1989).
<br>Crippen, Voronoi Binding Site Models, Journal of Computational Chemistry 8
     (7), 943-955 (1987).
<br>Boulu, et al., Voronoi Binding Site Model of a Polycyclic Aromatic
     Hydrocarbon Binding Protein, J. Med. Chem., 1990, 33, 771-775.
<br>Blankley, Introduction: A Review of QSAR Methodology, Academic Press, Inc.,
     1983, pp. 1-17.
<br>Nicklaus, et al., QSAR of Conformationally Flexible Molecules: Comparative
     Molecular Field Analysis of Protein-Tyrosine Kinase Inhibitors, Journal of
     Computer-Aided Molecular Design, 6 (1992) 487-504.
 </TD></TABLE>
  <BR>
  <I>Primary Examiner:</I>  Voeltz; Emmanuel T.
<BR>
  <I>Assistant Examiner:</I>  Kemper; M.
<BR>
  <I>Attorney, Agent or Firm:</I> D'Alessandro & Ritchie
<BR>
<HR>
<CENTER><B><I>Parent Case Text</B></I></CENTER>
<HR>
<BR><BR>CROSS-REFERENCE TO RELATED APPLICATION
<BR><BR>This is a file-wrapper continuation of patent application Ser. No.
     08/066,389, filed May 21, 1993 now abandoned.
<HR>
<CENTER><B><I>Claims</B></I></CENTER>
<HR>
<BR><BR>1. A method in a computer for predicting activity of molecules with respect
     to a chemical function based on known activities of a plurality of
     molecules, said molecules each having one or more conformations and
     orientations, each combination of a conformation and an orientation
     defining a pose of a molecule, said method comprising:
<BR><BR>(a) operating a computer to define one or more poses of each molecule as
     the initial poses of an initial training set;
<BR><BR>(b) operating a computer to construct a model in said computer with
     parameters for predicting activity of poses with respect to said chemical
     function and setting model parameter values;
<BR><BR>(c) operating a computer to predict the activities of at least some of said
     initial poses in the initial training set using the model and said model
     parameter values and comparing the predicted activities of initial poses
     of molecules to results of a set of actual tests for such activities of
     such molecules;
<BR><BR>(d) modifying said model parameter values in a computer based on a prior
     comparison between predicted activities of poses in the initial or an
     updated training set and said results of a set of actual tests for such
     activities to minimize the differences between the predicted activities of
     said at least some of the poses of molecules in such set and said results
     of a set of actual tests for such activities of such molecules, and
     modifying or selecting poses of the molecules to obtain an updated
     training set of enhanced poses with higher predictive value than poses
     prior to the modifying step;
<BR><BR>(e) operating said computer to use the model and modified model parameters
     values to predict the activity of a molecule not in the training set, and
     having unknown activity; and
<BR><BR>(f) visually displaying using computer graphics, in response to said
     conditionally modified model, a representation of a second new molecule
     not in the training set, and having unknown activity.
<BR><BR>2. The method of claim 1, further comprising:
<BR><BR>(f) predicting the activities of at least some of said enhanced poses in
     the updated set using the modified parameter values and comparing the
     predicted activities of enhanced poses of molecules to the known
     activities of such molecules; and
<BR><BR>(g) repeating steps (d) and (f) prior to step (e), wherein step (d) is
     repeated based on a prior comparison between predicted activities of poses
     in the updated set and their known activities.
<BR><BR>3. The method of claim 2, wherein step (g) is carried out until there is no
     substantial change in the model parameter values and the enhanced poses.
<BR><BR>4. The method of claim 1, wherein said modifying step employs gradient
     descent in modifying the poses and the model parameter values.
<BR><BR>5. The method of claim 1, wherein said modifying step in (d) first
     iteratively modifies the model parameter values until the differences
     between the predicted activities of said at least some of the enhanced
     poses of molecules and the known activities of such molecules are
     minimized to arrive at a set of modified model parameter values and then
     iteratively modifies the poses to maximize their activities and to obtain
     enhanced poses.
<BR><BR>6. The method of claim 5, wherein each time after poses of molecules in the
     training set have been modified, said modifying step in (d) iteratively
     modifies the model parameter values until the differences between the
     predicted activities of said at least some of the enhanced poses of
     molecules and the known activities of such molecules are minimized to
     obtain a set of modified parameter values, so that any pose modification
     thereafter will be in accordance with said set of modified parameter
     values.
<BR><BR>7. The method of claim 1, wherein the pose of each molecule in the set that
     has higher predicted activity than other poses in the set of the same
     molecule defines the best pose of such molecule, and wherein said model
     parameter values are modified in step (d) based on a prior comparison
     between predicted activities of the best poses in the set and their known
     activities to minimize the differences between the predicted activities of
     said at least some of the best poses of molecules in the set and the known
     activities of such molecules.
<BR><BR>8. The method of claim 1, said model constructing step including extracting
     a set of feature values from each of said initial poses related to said
     activity and setting an initial value for each of the features to be some
     of the model parameter values.
<BR><BR>9. The method of claim 8, said model constructing step further including
     setting initial mean and standard deviations of a feature value and a
     Gaussian-like function representing a contribution to predicted activity
     of a pose as a function of said feature value in relation to its initial
     mean and standard deviations.
<BR><BR>10. The method of claim 9, wherein said model constructing step further
     includes setting a positive or negative weighting factor for said Gaussian
     function.
<BR><BR>11. The method of claim 1, wherein an error function is defined for each
     pose, said function being a difference between the predicted activity of
     such pose of a molecule and the known activity of such molecule, wherein
     said modifying step includes deriving a total error function indicating
     the sum of the individual error functions of each of some of the poses and
     changing the model parameter values to minimize the total error function.
<BR><BR>12. The method of claim 11, wherein said modifying step employs gradient
     based steps to minimize the error function.
<BR><BR>13. The method of claim 1, wherein said pose modifying step in step (d)
     modifies the poses as functions of parameters including orientation and
     conformation parameters.
<BR><BR>14. The method of claim 13, wherein said functions are differentiable and
     said pose modifying step includes differentiating the functions with
     respect to orientation and conformation parameters.
<BR><BR>15. The method of claim 1, further comprising setting a set of ordered
     numerical values according to a preset order to represent the known
     activities of said plurality of molecules, wherein said modifying step (d)
     also includes adjusting the set of ordered numerical values while
     retaining the preset order to reduce the differences between the predicted
     activities of said at least some poses of molecules in the initial or an
     updated training set and the known activities of such molecules.
<BR><BR>16. The method of claim 1, further comprising, prior to the selecting step,
     searching for conformers of the molecules in the training set and aligning
     the conformers relative to one another to form possible poses.
<BR><BR>17. The method of claim 1, wherein said using step (e) also indicates which
     conformer of said molecule not in the training set would have the highest
     predicted activity with respect to said chemical function.
<BR><BR>18. The method of claim 1, wherein said using step also indicates which
     properties of said molecule not in the training set would have effects on
     its predicted activity with respect to said chemical function.
<BR><BR>19. The method of claim 1, further comprising visually displaying
     relationship between poses of molecules and model parameter values using
     computer graphics.
<BR><BR>20. The method of claim 19, further comprising modifying said poses with
     respect to the model parameter values displayed to modify the predicted
     activities of the poses.
<BR><BR>21. The method of claim 1, wherein said using step includes searching a
     database of molecules with unknown activities and predicting their
     activities.
<BR><BR>22. The method of claim 1, wherein said model constructing step includes
     setting a sigmoid function representing a contribution to predicted
     activity of a pose as a sum of the weighted Gaussians of one or more
     individual feature values.
<BR><BR>23. The method of claim 22, wherein said model constructing step further
     includes setting another sigmoid function representing the overall
     predicted activity of a pose as a weighted sum of the sigmoid functions.
<BR><BR>24. A method of operating a computer for predicting activity of molecules
     with respect to a chemical function based on known activities of a
     training set of molecules, said molecules in the set each having one or
     more conformations and orientations, each combination of a conformation
     and an orientation defining a pose of a molecule, said method comprising:
<BR><BR>operating a computer to extract a set of feature values from each a set of
     results from actual tests performed for each of said poses of molecules in
     the training set, said feature values related to said activity, said
     extracting step including the following steps:
<BR><BR>(a) creating a surface representation in said computer of each of the poses
     of molecules in the training set; and
<BR><BR>(b) obtaining a feature value between at least one sampling point and a
     point on said surface representation in said computer of each of the poses
     constructing a model for predicting activity of poses with respect to said
     chemical function using said feature values and using the model to predict
     the activity of a molecule not in the training set.
<BR><BR>25. The method of claim 24, wherein said creating step creates said
     representations by finding van der Waals surface representations of atoms
     on the surface of each of the poses.
<BR><BR>26. The method of claim 25, wherein said finding step includes:
<BR><BR>finding a first atom of the molecule with its center at a minimum distance
     to a sampling point using a squared distance function;
<BR><BR>finding a set of atoms in the vicinity of the first atom whose van der
     Waals radii are larger than that of the first atom, if any; and
<BR><BR>determining from a square root function which of the atoms in the set has a
     van der Waals surface closer to the sampling point than that of the first
     atom, if any.
<BR><BR>27. The method of claim 24, wherein said creating step creates said
     representations by summing Gaussian surface representations of atoms on
     the surface of each of the poses.
<BR><BR>28. The method of claim 24, said obtaining step including determining the
     distances between said at least one point and the surface representations
     along predetermined directions.
<BR><BR>29. The method of claim 24, said obtaining step including:
<BR><BR>determining the minimum distance between said at least one point and the
     surface representations of the poses.
<BR><BR>30. The method of claim 29, further comprising:
<BR><BR>selecting a plurality of points around said surface representations; and
<BR><BR>determining the minimum distance between each of said points and the
     surface representations of the poses.
<BR><BR>31. The method of claim 30, wherein said points selecting step includes:
<BR><BR>forming an average surface representation of substantially all the poses;
     and
<BR><BR>selecting a plurality of points around said average surface representation.
<BR><BR>32. The method of claim 24, said feature values including a steric or
     electrostatic value.
<BR><BR>33. The method of claim 24, further comprising visually displaying
     relationship between poses of molecules and said model using computer
     graphics.
<BR><BR>34. The method of claim 33, further comprising modifying said poses with
     respect to the model displayed to modify the predicted activities of the
     poses.
<BR><BR>35. A method in a computer for arriving at a model for predicting activity
     of molecules with respect to a chemical function based on known activities
     of a training set of molecules, said molecules in the set each having one
     or more conformations and orientations, each combination of a conformation
     and an orientation defining a pose of a molecule, said method comprising:
<BR><BR>(a) operating a computer to define one or more poses from possible poses of
     each molecule as the initial poses of a training set;
<BR><BR>(b) operating a computer to construct a model in said computer with
     parameters for predicting activity of poses with respect to said chemical
     function and setting model parameter values;
<BR><BR>(c) operating a computer to predict the activities of at least some of said
     initial poses in the training set using the model and said model parameter
     values and comparing the predicted activities of initial poses of
     molecules to a set of results from actual tests performed for activities
     of such molecules;
<BR><BR>(d) modifying said model parameter values in said computer based on a prior
     comparison between predicted activities of poses in the set and said set
     of results from actual tests performed for activities to minimize the
     differences between the predicted activities of said at least some of the
     poses of molecules in the set and said set of results from actual tests
     performed for activities of such molecules, and also modifying or
     selecting poses of the molecules to obtain an updated training set of
     enhanced poses with greater predicted activities than poses in the set
     prior to the modifying step; and
<BR><BR>(e) visually displaying using computer graphics, in response to said
     modified model, a representation of a new molecule not in the training
     set, and having unknown activity.
<BR><BR>36. A method of operating a computer for predicting characteristics of an
     object based on known characteristics of a plurality of other objects,
     said other objects each having one or more representations, said method
     comprising:
<BR><BR>(a) operating a computer to define one or more representations from
     possible representations of each of said other objects as the initial
     representations;
<BR><BR>(b) operating a computer to construct a model in said computer for
     predicting characteristics of the representations;
<BR><BR>(c) operating a computer to predict the characteristics of at least some of
     said initial representations or an updated set of representations using
     the model and comparing the predicted characteristics of initial
     representations of said other objects to a set of results from actual
     tests performed for characteristics of such other objects, wherein for
     each of said other objects, the representation that has better
     characteristics than other representations of the same object defines the
     best representation of such object;
<BR><BR>(d) modifying said model in said computer based on a prior comparison
     between predicted characteristics of the best representations of said
     other objects and said set of results from actual tests performed for
     characteristics to minimize the differences between the predicted
     characteristics of said best representations of the other objects and said
     set of results from actual tests performed for characteristics of such
     objects;
<BR><BR>(e) operating said computer to use the modified model to predict the
     characteristics of an object, said object not being one of said other
     objects for which possible representations were chosen as the initial
     representations.
<BR><BR>37. The method of claim 36, further comprising:
<BR><BR>(f) repeating steps (c) and (d) prior to step (e), wherein step (c) is
     repeated based on a prior comparison between predicted characteristics of
     at least some of the representations of each object and the known
     characteristics of those objects.
<BR><BR>38. A method of operating a computer for predicting characteristics of an
     object based on known characteristics of a plurality of other objects,
     said other objects each having many representations, each representation
     called a pose and being defined by the object and values of one or more
     parameters defining pose parameters, said method comprising:
<BR><BR>operating a computer to define one or more poses from the possible
     representations of each of said other objects as the initial poses;
<BR><BR>(b) operating a computer to construct a model in said computer for
     predicting characteristics of the objects from one or more poses of the
     objects;
<BR><BR>(c) operating a computer to predict characteristics of at least some of
     said initial poses or enhanced poses using the model and comparing the
     predicted characteristics of the initial poses of said other objects to a
     set of results from actual tests performed for characteristics of such
     other objects, wherein for each of said other objects the pose that has
     better predicted characteristics than other poses of the same object
     defines the best pose of such object;
<BR><BR>(d) modifying said model in said computer based on a prior comparison
     between predicted characteristics of the best poses of said other objects
     and said set of results from actual tests performed for characteristics to
     minimize the differences between the predicted characteristics of said
     best poses of the other objects and said set of results from actual tests
     performed for characteristics of such objects;
<BR><BR>(e) operating a computer to define an updated set of enhanced poses by
     computing new pose parameters for each object such that the resulting pose
     is predicted by said model to have improved characteristics;
<BR><BR>(f) repeating steps (c), (d), and (e) one or more times; and
<BR><BR>(g) operating a computer to apply the modified model to predict the
     characteristics of an object, said object not being one of said other
     objects for which possible representations were chosen as the initial
     poses.
<BR><BR>39. A method for predicting activity of molecules with respect to a
     chemical function based on activities of a plurality of molecules, said
     method comprising
<BR><BR>operating a computer to define a plurality of molecules, each one of said
     molecules having at least one pose;
<BR><BR>operating a computer to define a training set having at least one pose for
     each one of said molecules;
<BR><BR>operating a computer to construct a model in a memory for predicting a
     result of an assay for a measure of activity relating to a set of desired
     physical properties for said molecule;
<BR><BR>operating a computer using said model to produce a prediction for a first
     pose of a first molecule in said training set;
<BR><BR>operating a computer using said model to produce a prediction for a second
     pose of said first molecule;
<BR><BR>conditionally modifying said model in said memory in response to a
     difference between said prediction and a result of an actual said assay
     conducted for said first pose;
<BR><BR>conditionally modifying said training set in said memory to replace said
     first pose with said second pose in response to a difference between said
     prediction for said first pose and said prediction for said second pose;
<BR><BR>repeating said steps of operating a computer using said model for said
     first and second poses, and conditionally modifying said model and said
     training set in memory, until a predetermined condition is reached;
<BR><BR>operating a computer using said model to produce a prediction for a pose of
     a new molecule, said new molecule not being in said training set;
<BR><BR>conducting an actual said assay for said new molecule;
<BR><BR>comparing said prediction for said pose of said new molecule with a result
     of said actual assay for said new molecule; and
<BR><BR>repeating said steps of operating a computer using said model for said pose
     of said new molecule, conducting an actual said assay for said new
     molecule, and said prediction, until a predetermined condition is reached.
<BR><BR>40. A method as in claim 39, comprising conditionally modifying said model
     in response to a difference between said prediction for said pose of said
     new molecule and said result of said actual assay for said new molecule.
<BR><BR>41. A method as in claim 39, comprising conditionally modifying said
     training set in response to a difference between said prediction for said
     pose of said new molecule and said result of said actual assay for said
     new molecule.
<BR><BR>42. A method as in claim 39, comprising
<BR><BR>operating said model for at least one pose for each one of a plurality of
     new molecules, said plurality of new molecules not being in said training
     set, to produce a prediction for each one of said plurality of new
     molecules;
<BR><BR>selecting a choice one of said plurality of new molecules in response to
     said prediction for each one of said plurality of new molecules;
<BR><BR>conducting an actual said assay for said choice one of said plurality of
     new molecules;
<BR><BR>comparing a result of said actual assay for said choice one of said
     plurality of new molecules with at least a part of said prediction for
     each one said plurality of new molecules; and
<BR><BR>repeating said steps of selecting a choice one, conducting an actual said
     assay for said choice one, and comparing a result of said actual assay for
     said choice one, until a predetermined condition is reached.
<BR><BR>43. A method as in claim 42, comprising
<BR><BR>conditionally modifying said model in response to a difference between said
     prediction for said choice one of said plurality of new molecules and said
     result of said actual assay for said choice one of said plurality of new
     molecules.
<BR><BR>44. A method as in claim 42, comprising
<BR><BR>conditionally modifying said training set in response to a difference
     between said prediction for said choice one of said plurality of new
     molecules and said result of said actual assay for said choice one of said
     plurality of new molecules.
<BR><BR>45. A method as in claim 39, wherein said model comprises a neural network,
     said neural network comprising
<BR><BR>a plurality of layers each having at least one node;
<BR><BR>said plurality of layers including a first layer having at least one node
     coupled to an input value;
<BR><BR>a second layer having at least one node coupled to a plurality of nodes of
     said first layer;
<BR><BR>said first layer having at least one node with a first transfer function,
     said first transfer function comprising a Gaussian function with
     parameters m, s, and z, said parameters being modifiable; and
<BR><BR>said second layer having at least one node with a second transfer function,
     said second transfer function comprising a sigmoid function with
     parameters, said parameters being modifiable.
<BR><BR>46. A method as in claim 39, wherein said new molecule is designed in
     response to said model.
<BR><BR>47. A method as in claim 39, wherein said new molecule is a catalyst, a
     carbohydrate, a coating agent, a cosmetic, an explosive, an industrial
     chemical, a paint, a perfuming agent, a petroleum derivative, a polymer,
     or a polypeptide.
<BR><BR>48. A method as in claim 39, wherein said new molecule is a pharmaceutical.
<HR>
<CENTER><B><I> Description</B></I></CENTER>
<HR>
<BR><BR>BACKGROUND OF THE INVENTION
<BR><BR>This invention relates in general to a machine-learning approach to
     modeling biological activities or other characteristics and, in
     particular, to a machine-learning approach to modeling biological activity
     for molecular design or other characteristics. In modeling biological
     activity, the approach is preferably shaped-based.
<BR><BR>The shape that a molecule adopts when bound to a biological target, the
     bioactive shape, is an essential component of its biological activity.
     This shape, and any specific interactions such as hydrogen bonds, can be
     exploited to derive predictive models used in rational drug design. These
     can be used to optimize lead compounds, design de novo compounds, and
     search databases of existing compounds for novel structures possessing the
     desired biological activity. In order to aid the drug discovery process,
     these models must make useful predictions, relate chemical substructures
     to activity, and confidently extrapolate to chemical classes beyond those
     used for model derivation.
<BR><BR>Physical data such as X-ray crystal structures of drug-target complexes
     provide a shape model directly and have led to recent successes in
     structure-based drug-design. However, in the absence of such data,
     rational drug design must rely upon predictive models derived solely from
     observed biological activity. Several methods exist that produce
     predictive models relying, in part, on molecular shape.
<BR><BR>Existing methods for constructing predictive models are unable to model
     steric interactions accurately, particularly when these interactions
     involve large regions of the molecular surface. Existing quantitative
     structure-activity relationship (QSAR) models are severely limited by the
     types of molecular properties they consider. Methods that employ
     properties of substituents assume that the molecules share a common
     structural skeleton, and hence cannot be extrapolated to molecules with
     different skeletons. Many methods employ ad hoc features that make it
     difficult to interpret the models as a guide for drug design.
     Pharmacophore models (e.g., BioCAD) model activity in terms of the
     positions of a small number of atoms of functional groups. This overcomes
     many of the problems of traditional QSAR methods, but it has difficulty
     addressing steric interactions.
<BR><BR>In U.S. Pat. No. 5,025,388 to Cramer, III, et al., a comparative molecular
     field analysis (COMFA) methodology is proposed. In this methodology, the
     three-dimensional structure for each molecule is placed within a
     three-dimensional lattice and a probe atom is chosen, placed successively
     at each lattice intersection, and the steric and electrostatic interaction
     energies between the probe atom and the molecule calculated for all
     lattice intersections. Such energies are listed in a 3D-QSAR table. A
     field fit procedure is applied by choosing the molecule with the greatest
     biological activity as the reference in conforming the remaining molecules
     to it. In determining which conformation of the molecule to use in the
     analysis, COMFA proposes using averaging or Boltzman distribution
     weighting to determine a most representative conformer. After the 3D-QSAR
     table is formed, a partial least squares analysis and cross-validation are
     performed. The outcome is a set of values of coefficients, one for each
     column in the data table, which when used in a linear equation relating
     column values to measured biological values, would tend to predict the
     observed biological properties in terms of differences in the energy
     fields among the molecules in the data set, at every one of the sampled
     lattice points.
<BR><BR>The COMFA method is disadvantageous since it requires that the chemist
     guess the alignment and active conformation of each molecule or,
     alternatively, compute the average or a weighted distribution of the
     steric and electrostatic fields for all conformations. This can undermine
     the applicability and accuracy of the method.
<BR><BR>The COMFA method is also disadvantageous because it constructs a linear
     model to predict activity as a function of the properties measured at the
     grid points. Biological activity is an inherently non-linear function of
     molecular surface properties (such as electrostatic, weak polar, and van
     der Waals interactions). In COMFA these nonlinearities must be captured in
     the field values measured at the grid points.
<BR><BR>None of the above-described approaches is entirely satisfactory. It is
     therefore desirable to provide an improved approach for modeling
     biological activity in which the above-described difficulties are
     alleviated.
<BR><BR>SUMMARY OF THE INVENTION
<BR><BR>An important advantage of the approach of this application over COMFA is
     that a non-linear mathematical model is employed. This permits a surface
     representation that is easier to understand and more efficient to compute.
     The non-linearity is handled by a mathematical model.
<BR><BR>This invention is based on the observation that it is difficult for a
     scientist to provide good guesses about the best bioactive pose for each
     molecule and that it is desirable to provide a method where the model can
     be refined to generate new molecular orientations and conformations even
     though the initial guesses may be mediocre. This invention is also based
     on the observation that almost all of the chemical interactions between
     molecules of interest to biochemistry and medicinal chemistry are based
     entirely on surface interactions so that the predictive model would best
     utilize a surface-based representation of molecular shape.
<BR><BR>One aspect of the invention is directed towards an iterative process that
     produces better models. In many binding interactions between molecules,
     not all of the characteristics of the molecule considered are of equal
     importance. Using a modeling approach permits the user to focus on the
     salient features of the molecules. This aspect of the invention is
     directed towards a method for predicting activity of molecules with
     respect to a chemical function based on known activities of a plurality of
     molecules. Each molecule has one or more conformations and orientations,
     and each combination of a conformation and an orientation defines a pose
     of a molecule. The method comprises selecting one or more poses from
     possible poses of each molecule as the initial poses of a training set. A
     model is then constructed with model parameters for predicting activity of
     poses with respect to said chemical function and model parameter values
     are then set. The activities of at least some of the initial poses in the
     training set are predicted using the model and the model parameter values.
     The predicted activities of at least some of the initial poses of
     molecules are then compared to the known activities of such molecules. The
     model parameter values are then modified based on a prior comparison
     between predicted activities of poses in the set and their known
     activities to minimize the differences between the predicted activities of
     said at least some of the poses of molecules in the set and the known
     activities of such molecules. The poses of the molecules are also modified
     or re-selected so as to obtain an updated training set of enhanced poses
     with higher predictive value than poses in the set prior to the modifying
     step. The model and modified model parameter values are then used to
     predict the activity of additional molecules whose activity is unknown.
<BR><BR>In the preferred embodiment, the model parameter values and poses are
     modified iteratively until the model parameter values as well as the poses
     both converge before the model and the modified model parameter values are
     used to predict the activity of the molecules whose activity is unknown.
     For each molecule, the pose having the highest predicted activity is the
     best pose of the molecule, Preferably, the model parameter values are
     modified based on a prior comparison between predicted activities of only
     the best pose or poses for each molecule in the set and their known
     activities.
<BR><BR>Another aspect of the invention is directed toward a shape-based approach
     to modeling biological activity. This aspect is directed towards a method
     for predicting activity of molecules with respect to a chemical function
     based on known activities of a training set of molecules. Each molecule in
     the set has one or more poses as defined above. The method comprises
     extracting a set of feature values from each of the poses of molecules in
     the training set, said feature values related to said activity. The
     extracting step includes the following two steps: creating a surface
     representation of each of the poses of each of the molecules in the
     training set and obtaining a feature value between at least one sampling
     point and a point on the surface representation of each of the poses. A
     model is then constructed for predicting activity of poses with respect to
     the chemical function using the feature values and the model is then used
     to predict the activity of a molecule not in the training set. In the
     preferred embodiment, the feature value is obtained by determining the
     minimum distance between said at least one point and the surface
     representations of the poses.
<BR><BR>Yet another aspect of the invention is directed towards a general
     machine-learning method for predicting characteristics of an object based
     on known characteristics of a plurality of other objects. Each object has
     one or more representations. The method comprises selecting one or more
     representations from possible representations of each of the other objects
     as the initial representations, constructing a model for predicting
     characteristics of the representations, and predicting the characteristics
     of at least some of the initial representations using the model and
     comparing the predicted characteristics of initial representations of the
     other objects to their known characteristics. For each of the other
     objects, the representation that has better characteristics than other
     representations of the same object defines the best representation of the
     object. The method further comprises modifying the model based on a prior
     comparison between predicted characteristics of the best representations
     of the other objects and their known characteristics to minimize the
     differences between the predicted characteristics of said best
     representations of the other objects and their known characteristics. The
     last step involves using the modified model to predict characteristics of
     an object not in the training set.
<BR><BR>BRIEF DESCRIPTION OF THE DRAWINGS
<BR><BR>The file of this patent contains at least one drawing executed in color.
     Copies of this patent with color drawing(s) will be provided by the Patent
     and Trademark Office upon request and payment of the necessary fee.
<BR><BR>FIG. 1 is a flow diagram of a molecular shape learning system to illustrate
     the invention.
<BR><BR>FIG. 2 is a schematic illustration of four different molecules, each with
     one or more different orientations and conformations or poses to
     illustrate the bootstrap procedure of FIG. 1.
<BR><BR>FIG. 3 is a schematic view of the van der Waals surface representations of
     atoms on a surface of a pose.
<BR><BR>FIG. 4 is a schematic illustration of a pose of a molecule and a number of
     points around the surface representation to illustrate a point based
     system for feature extraction.
<BR><BR>FIG. 5A is a schematic view of a ray-based feature extraction system to
     illustrate the invention.
<BR><BR>FIG. 5B is a schematic view of a pose of a molecule and a ray-based feature
     extraction system to illustrate such system.
<BR><BR>FIG. 5C is a schematic view of one or more poses of four different
     molecules to illustrate the ray-based feature extraction system.
<BR><BR>FIG. 6A is a graphical illustration of a Gaussian function to illustrate
     the invention.
<BR><BR>FIG. 6B is a schematic view of a ray-based feature extraction system and
     tolerance boxes to illustrate the relationship between activity of the
     molecule and its feature values along the rays of the ray-based system.
<BR><BR>FIG. 6C is a schematic view of the ray-based feature extraction system and
     tolerance boxes in relation to a pose to illustrate the invention.
<BR><BR>FIG. 7 is a flow chart illustrating iterative model parameter modification
     and reposing of molecules in order to illustrate the preferred embodiment
     of the invention.
<BR><BR>FIGS. 8A-8C and 9A-9C are two sets of figures each set showing a molecule
     undergoing re-orientation and re-conformation to illustrate the preferred
     embodiment of the invention.
<BR><BR>FIG. 10 is a schematic view illustrating a method for finding the minimum
     distance between the sampling point and the van der Waals surfaces of
     atoms of a molecule to illustrate the invention.
<BR><BR>FIG. 11 is a crude diagram of learned requirements for musk odor activity
     to illustrate an example applying the invention of this application.
<BR><BR>FIGS. 12A-12F are graphical illustrations of six different molecules
     showing the relations between their structures and activities to
     illustrate the invention.
<BR><BR>FIG. 13 is a schematic view of a portion of a 16.times.16 grid to
     illustrate a machine-learning method for predicting characteristics of
     objects to illustrate another aspect of the invention.
<BR><BR>FIG. 14 is a flow chart to illustrate the aspect of the invention of FIG.
     13.
<BR><BR>GENERAL DESCRIPTION OF THE PREFERRED EMBODIMENT
<BR><BR>A novel modeling approach is proposed using a surface-based representation
     of molecular shape that employs neural network learning techniques to
     derive robust predictive models. Trained models predict the bioactive
     shape of molecules and can be readily interpreted to guide the design of
     new active compounds. The method is demonstrated on musk odor perception,
     a problem believed to be determined by subtle steric interactions.
<BR><BR>This approach combines three advances: a representation that characterizes
     surface shape such that structurally diverse molecules exhibiting similar
     surface characteristics are treated as similar; a new machine learning
     methodology that can accept multiple orientations and conformations of
     both active and inactive molecules; and an iterative process that applies
     intermediate models to generate new molecular orientations to produce
     better predictive models. The method is first outlined, then predictive
     results are presented, and lastly the details of the method are described.
<BR><BR>The procedure begins by conducting a search for low energy conformations of
     the training molecules. This provides a pool of energetically accessible
     shapes for each molecule. They are then placed into a set of initial
     orientations that coarsely align the gross shape and electrostatically
     important regions of the molecules. From these starting poses, we extract
     feature values using either the point-based or ray-based feature
     extraction method. These feature values (along with the known activities
     of the corresponding molecules) are then provided as input to a neural
     network, which is trained to construct an initial model of activity. To
     improve predictive performance, we apply the learned model to
     automatically compute additional discriminative molecular poses. The model
     is refined using the new poses, and the process iterates until it
     converges on a best model and a best pose for each molecule. Activity
     predictions for new molecules are then obtained by applying the final
     model. As in the training process, the model automatically computes the
     best conformation and orientation for each molecule--the predicted
     bioactive pose. It can be visualized in three dimensions to identify
     required, allowed and disallowed regions of space around a candidate
     molecule.
<BR><BR>DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT
<BR><BR>The invention will now be described in detail by reference to figures. FIG.
     1 is a flow chart showing the overall structure of the system. In order to
     predict the activity of molecules not yet synthesized or for which not
     much is known with respect to a particular chemical function, such as
     binding to a particular receptor, one would first start with molecular
     structures and assay values of known molecules with known activities with
     respect to such chemical function. This is accomplished in the first step
     20 in FIG. 1 by gathering the training data. Such data is subsequently
     used in a learning model which is refined to generate consistent
     hypotheses to explain the training data. However, in order to make the
     learning process more efficient, it is desirable to employ a bootstrap
     procedure 22. This procedure is illustrated in FIG. 2 in three steps:
     finding the conformers, posing the conformers and selecting initial poses
     from the poses to form an initial training set. After the training set is
     formed, the set is used in a learning step 24 to refine a system which is
     then used to predict (26) the activity of a molecule not in the training
     set.
<BR><BR>As shown in FIG. 2, the training data includes data on four different
     molecules, where molecules 1 and 2 are active with respect to a particular
     chemical function and molecules 3 and 4 are inactive with respect to such
     function. As known to those skilled in the art, biologically active
     molecules can take on different shapes known as conformers or
     conformations defined by the internal torsion angles of the rotatable
     bonds in the molecule. As shown in FIG. 2, molecules 1 and 4 each have
     only one conformer, molecule 2 two conformers and molecule 3 three
     conformers. In order to increase the computational efficiency in learning,
     it is desirable to choose only the conformations that are best in
     confirming or refuting the learning model.
<BR><BR>The first step in this selection involves posing the molecule. A pose of a
     molecule is defined by its conformation (internal torsion angles of the
     rotatable bonds) and orientation (three rigid rotations and translations).
     This mathematically defines the pose of the molecule. First, a conformer
     of an active molecule is chosen and its pose is first fixed. As shown in
     FIG. 2, molecule 1 is chosen and its pose 30 is fixed. Then the conformers
     of the other molecules are realigned to match pose 30, such as in the
     realignment of conformer 32 along arrow 34. Conformer 36 of molecule 3 is
     moved along all three dimensions until it overlaps as much as possible
     pose 30 as shown in FIG. 2. In chemical terms, this is analogous to
     permitting the molecule to rotate, translate and alter its conformation to
     achieve its best possible fit to the binding site. The rotation,
     translation and alteration in the internal torsion angles of the rotatable
     bonds in a molecule is referred to herein as reposing of the molecule.
<BR><BR>In other words, since the fixed pose of molecule 1 known to have high
     activity is used as the reference for reposing the remaining molecules,
     this crudely simulates the process of reposing the other molecules to
     achieve the best possible fit to the binding site. The reposed conformers
     of molecules 2, 3 and 4 are shown in FIG. 2 in the category labeled
     "posed". The above-described process can be performed using a number of
     software packages available commercially, such as Catalyst from BioCAD,
     Foster City, Calif., and Batchmin available from Columbia University, New
     York City, N.Y.
<BR><BR>The learning process 24 now begins with a selection of only some of the
     poses to be in the training set. In other words, poor matches are dropped
     for computational efficiency in the subsequent learning process. For
     example, two of the poses of molecule 3 have been dropped to arrive at a
     training set of five selected poses as shown in FIG. 2. In making the
     selection, various properties of the four molecules known to chemists may
     be used, including physical and chemical properties such as shape,
     electrostatic interaction, solvation and biophysical properties.
<BR><BR>Before the selected poses may be used for training, the relevant features
     of these poses are first extracted. The COMFA methodology described in
     U.S. Pat. No. 5,025,388, for example, employs a three-dimensional lattice
     structure and extracts the relevant features by calculating the steric and
     electrostatic interaction energies between a probe atom placed at each of
     the lattice intersections and the molecule. As indicated above, the
     receptor site in a binding interaction "sees" only the surfaces and not
     the interior of a molecule. By choosing a three-dimensional lattice and
     modeling the learning process based on the interaction energies between
     these lattice points and the molecule, the COMFA methodology has failed to
     focus in on the critical portion of the molecule, namely its surface.
     Consequently, extraneous data not particularly relevant to binding
     interactions may be included and may compromise the subsequent learning
     process and cause it to give incorrect weight to critical surface
     features. The feature extraction methods of this invention overcome such
     defects.
<BR><BR>Surface Representation
<BR><BR>This invention envisions creating a surface representation of each of the
     poses and then obtaining a feature value between at least one sampling
     point and a point on the surface representation of each of the poses. FIG.
     3 is a schematic illustration of a portion of a surface of a molecule with
     five atoms whose nuclei are at 42-50 at such surface portion. The van der
     Waals surface of each of the five atoms is first found. The van der Waals
     surfaces of adjacent atoms would intersect; thus, the van der Waals
     surface 42' of atom with nucleus at 42 intersects surface 44' of atom with
     nucleus at 44 at ridge 52. The portions of surfaces 42', 44' that extend
     outwards from ridge 52 are then taken as a surface representation of the
     molecule around atoms with nuclei at 42 and 44. Thus, the curved surface
     60, having a number of ridges such as ridge 52 at the intersections of
     adjacent van der Waals surfaces, is a surface representation of the
     portion of the molecule shown in FIG. 3.
<BR><BR>As known to those skilled in the art, the electron density around each atom
     can be represented as a Gaussian function of distance from the nucleus of
     the atom where the peak of such Gaussians would more or less coincide with
     the van der Waals radius of the atom. A surface representation of the
     portion of the molecule shown in FIG. 3 can then be obtained by summing
     the Gaussian functions for all the five atoms with nuclei at 42-50 where
     the sum function also has a peak surface that would more or less coincide
     with surface 60. The surface representation arrived at using the van der
     Waals surfaces of the atom has been found to be adequate and easy to find
     for most purposes for modeling biological and chemical activity whereas
     the sum of the Gaussian approach gives a scientifically more rigorous
     representation of such surface. The details of finding the van der Waals
     surfaces of atoms and calculations involving a surface such as surface 60
     are known to those skilled in the art and will not be explained in detail
     here; although an improved method of calculating the minimum distance
     between such surface and a sampling point is discussed below. Similarly,
     the Gaussian distributions for the atoms and method for summing them are
     also known to those skilled in the art and will not be explained in detail
     here. Other than van der Waals and Gaussian surface representations, other
     types of surface representation are possible, such as a Connolly surface.
     See, M. J. Connolly, J. Appl. Cryst., 16, 548 (1983).
<BR><BR>Feature Extraction
<BR><BR>The feature values, including steric, electrostatic or other feature values
     may be extracted by first specifying at least one sampling point and then
     obtaining a feature value between such sampling point and a point on the
     surface representation of each of the poses. In the preferred embodiment,
     the point is outside but near the molecular surface and the feature value
     is extracted by determining, for example, the minimum distance between
     such sampling point and the surface representation of the pose. For
     simplicity, a surface representation of a pose determined in the manner
     above will be referred to simply as the surface of the pose. An
     electrostatic feature value may be extracted as the electrostatic
     interaction between a probe atom placed at such sampling point and the
     pose. Alternatively, the electrostatic feature value may be the sum of the
     Coulomb force interactions between the probe atom and atoms of the pose
     surface. The abovedescribed approach will be referred to herein as the
     point-based feature extraction approach. Preferably, a number of sampling
     points are chosen surrounding the poses. In other words, the same sampling
     points are used to extract features from each of the poses in the training
     set. To arrive at a common set of sampling points, one may select the
     points by reference to the averaged position of the poses in the training
     set.
<BR><BR>FIG. 4 is a schematic illustration of a number of sampling points 62
     surrounding the surface of a pose 64, which may be an averaged position of
     the poses in the set. If the fine features of portion 64' of the pose are
     deemed to be particularly important for the activity of the pose, the
     density of sampling points 62 may be increased surrounding such portion as
     illustrated in FIG. 4. Point based feature extraction has the advantage
     that the feature values (minimum distances, electrostatic interaction, . .
     . ) will not change abruptly upon changing the orientation or conformation
     of the pose. Also, when differentiability of the feature values with
     respect to orientation and conformational parameters is important, point
     based feature extraction gives rise to feature values which are
     differentiable functions of the orientation and conformational parameters.
     The steric feature values may simply comprise the minimum distance between
     each of the sampling points and the surface representation of the
     molecule, such as a', b', c', d', e' as shown in FIG. 4 The electro-static
     feature values may comprise the electrostatic interaction energies or sums
     of Coulomb forces between a probe atom placed at each of the sampling
     points and the molecule. Other feature values may be extracted in a
     similar manner.
<BR><BR>Another possible feature extraction method is a ray-based method as
     illustrated in FIGS. 5A-5C. In ray-based feature extraction, first one or
     more points are chosen, such as point 72, preferably located inside the
     molecular surface, and a number of rays with fixed directions are chosen,
     such as rays 74a, 74b, 74c, 74d diverging from point 72. The points at
     which the surface representation of the molecule intersects these rays
     would yield the steric feature values a, b, c, d as illustrated in FIG.
     5B. Thus, the four rays intersecting the surface of pose 76 intersect the
     pose surface at distances a, b, c, d from point 72 so that the set of
     feature values representing pose 76 is [a, b, c, d, . . . ], a, b, c, d
     being the steric feature values. As shown in FIGS. 5B, 5C, pose 76 of
     molecule 1 has feature values [a, b, c, d, . . . ]. The two poses of
     molecule 2 and the single pose of each of molecules 3 and 4 each has a set
     of feature values representing it as illustrated in FIG. 5C.
<BR><BR>Form of the Model
<BR><BR>Once features have been extracted for each initial pose in the initial
     training set, these features are input to a parameterized mathematical
     model (neural network) to produce an activity prediction. Let V (M, P) be
     the vector of n features extracted to represent molecule M in pose P. Let
     the kth component of this vector be denoted V (M, P).sub.k.
<BR><BR>During training, the optimal values for the model parameters are
     determined. It will be understood that the scope of this invention
     includes a wide range of mathematical models, including linear models and
     nonlinear models. In the preferred embodiment, the model has the form:
     ##EQU1##
     where m is the number of weights
<BR><BR>Sigmoid (x)=1/(1+exp(-x))
<BR><BR>exp is the exponential function (whose base e is the base of the natural
     logarithm)
<BR><BR>u.sub.j is a real-valued weight and
     ##EQU2##
     .mu..sub.i a real-valued location parameter .sigma..sub.i is a real-valued
     width parameter
<BR><BR>The parameters of this model are:
<BR><BR>u.sub.j (j=1 . . . n)
<BR><BR>v.sub.ji (j=1 . . . n, i=1 . . . m)
<BR><BR>.mu..sub.i (i=1 . . . m)
<BR><BR>.sigma..sub.i (i=1 . . . m).
<BR><BR>n
<BR><BR>In this embodiment, the function G is a Gaussian-like function that will
     produce large values when the measured feature V (M, P).sub.i is near to
     .mu..sub.i and smaller values when the measured feature is distant from
     .mu..sub.i. The value of .sigma..sub.i controls how rapidly the value of G
     decreases as V (M, P).sub.i moves away from .mu..sub.i. FIG. 6A shows a
     sketch of the shape of the G function.
<BR><BR>Given an initial set of training poses, the training process is initialized
     by providing starting values for each of the parameters. In the preferred
     embodiment, the values of u.sub.j and v.sub.ji are set to small random
     positive values in the range from 0.0 to 0.2; .mu..sub.i is initialized to
     be a small amount (1.0) less than the mean of the values of V (M, P).sub.i
     for all molecules and poses in the training data set. The value of
     .sigma..sub.i is initially set to a value of 0.25. The value of n, the
     number of intermediate sigmoids, is initialized to 1. If inadequate
     predictions are obtained, n can be increased and the model re-trained
     until a sufficient value of n is found.
<BR><BR>FIG. 6B provides a graphical interpretation of the model applied to
     ray-based features. Each Gaussian G (V (M,P).sub.j, .mu..sub.i,
     .sigma..sub.i) can be approximately viewed as a box lying along the ray at
     a location determined by .mu..sub.i. The size (length) of the box is
     determined by .sigma..sub.i. If the values of v.sub.ji are positive (for
     each value of j), then this indicates that in order to exhibit activity,
     it is desirable that the molecular surface pass through this box. For
     example, box 82 lies at a position .mu..sub.1 along ray 74a. The size of
     the box is determined by .sigma..sub.1. As shown in FIG. 6C, molecule 1
     falls inside all of the boxes 82, 84, 86 and 88, so (assuming the v.sub.ji
     are all positive), it will have very high predicted activity. If the
     values of v.sub.ji are negative for some ray i, then the box represents a
     region where the molecular surface should not be located. This is how the
     model represents excluded regions for the molecular surface.
<BR><BR>Because contributions are weighted and summed by the sigmoid functions, a
     molecule can still have fairly high predicted activity even if its surface
     does not pass through all of the desirable boxes. Notice that the
     predicted activity of a molecule will vary as the pose of the molecule
     varies. For each pose, the molecular surface can intersect the various
     rays at different points, and hence produce different feature values. The
     final predicted activity of each molecule is determined by the pose that
     gives the highest predicted activity among all poses considered for that
     molecule according to the final learned model.
<BR><BR>The discussion in the preceding paragraphs has focused on steric features,
     but the same mathematical model applied equally well to electrostatic
     features. The values of .mu..sub.i and .sigma..sub.i for an electrostatic
     feature i describe an interval ("Box") of desirable or undesirable values
     for the feature (depending on the values of v.sub.ji). In fact, the same
     mathematical model is applicable to other biological activity types
     including but not limited to affinity, agonism, potency, receptor
     selectivity and tissue selectivity.
<BR><BR>Training the Model
<BR><BR>The training of the model will now be described in reference to FIG. 7.
     FIG. 7 is a flow chart illustrating in more detail the learning step 24
     and prediction step 26 of FIG. 1.
<BR><BR>In the preferred embodiment, the sampling points 62 are chosen by reference
     to an average surface representation obtained by averaging the surface
     representations of the poses in the training set. Thus, if surface
     representation 64 is an averaged surface representation of all the poses,
     then the sampling points 62 are chosen by reference to such surface. The
     averaging process to obtain the average representation of a set of poses
     is known to those skilled in the art.
<BR><BR>As explained above in reference to FIG. 2, an initial set of poses is
     selected to form the training set in order to train the model (block 100).
     Then the initial values for the parameters n, .mu..sub.i, .sigma..sub.i,
     v.sub.ji, and u.sub.j are chosen (block 102). The feature values of the
     poses in the training set are extracted as described above. However, it
     will be understood that the training system of the invention is not
     limited to the point-based or ray-based feature extraction methods above.
     Then the predicted activity of each of the poses in the training set is
     calculated using the model and the parameter values set initially by
     using, for example, the equations above. For each molecule, the pose with
     the highest predicted activity is chosen as the best pose of the molecule
     (block 106). Then the parameter values set initially for feature i are
     modified to minimize the differences between the predicted and actual
     activities of preferably only the best poses of the molecules.
<BR><BR>When receptor sites are present in the vicinity of the molecules used for
     training, it is known that the presence of such sites would influence the
     orientation and conformations of molecules present so that in actual fact,
     the molecules would repose under such influence to attempt to conform to
     the pose with the highest activity. Therefore, the above-described step in
     block 108 of training the model by reference to only the best poses of
     molecules resembles the physical process. It is of course possible to
     modify the parameter values in reference to poses in addition to or other
     than the best poses; all such variations are within the scope of the
     invention.
<BR><BR>If p.sub.j is the predicted activity of a particular pose j and a.sub.j its
     actual activity, then an error function for the training set of poses can
     be formed by the following equation:
     ##EQU3##
     where m is the total number of poses (preferably only the best poses) in
     the set in reference to which the parameter values are to be modified. A
     wide variety of computational methods may be applied to minimize the error
     function with respect to the parameters of the model (e.g., u.sub.j,
     v.sub.ji, .mu..sub.i, .sigma..sub.i, n). Such methods are known to those
     skilled in the art and will not be described here. In the preferred
     embodiment, the gradient of the error function with respect to these
     parameters (except for n) is computed, and gradient descent methods are
     applied. Other methods such as conjugate gradient, Newton methods,
     simulated annealing, and genetic algorithms may also be used and are
     within the scope of the invention.
<BR><BR>After the differences between predicted and actual activities of poses
     (e.g., best poses) have been minimized, such as by minimizing the above
     error function, such differences are compared to preset thresholds
     (diamond 110). If the differences are below the preset threshold or
     thresholds, one concludes that the process has converged and proceeds to
     the step in block 112. If not, then one returns to block 106 to calculate
     the predicted activities of poses in the training set by reference to the
     modified parameter values and again choose the best pose for each molecule
     having the highest predicted activity. The parameter values are again
     modified to minimize differences between predicted and actual activities
     of best poses. This loop is repeated until the differences are found to be
     below preset threshold or thresholds and the same best poses are chosen
     every time.
<BR><BR>Then the molecules are reposed to maximize their activities and from the
     possible poses after the reposing, poses are chosen to form a new training
     set (block 112), a process such as that illustrated in FIG. 2 above.
     Instead of reposing the molecules, it is possible to simply re-select from
     the initial set of poses to form the training set of poses, as illustrated
     in FIG. 2. However, it is believed to be preferable to repose the
     molecules in order to form a new training set. The new training set is
     compared to the prior training set to see whether the changes to the poses
     are below certain set threshold or thresholds (diamond 114). If the
     changes are found to be below the threshold(s), then the process of
     training the model is completed and one proceeds to the prediction step in
     block 116. If the changes to the poses are not below the threshold or
     thresholds, (diamond 114), then one returns to block 104. Since the
     orientation and conformation of the poses may have changed, these new
     poses will have different feature values from those in the original
     training set. Therefore, the feature extraction step needs to be repeated.
     The process of reposing is illustrated in FIGS. 8A-8C and 9A-9C by
     reference to a ray-based system. As shown in FIGS. 8A, 8B, molecule 3 is
     reposed by first re-orienting the molecule with respect to the sampling
     points (or to the rays in the ray-based system). When the parameter values
     of the model are modified, the positions of the boxes in FIG. 8 have been
     modified so that they are not the same as the positions of the boxes in
     the prior application of the model to the molecule. Therefore, molecule 3
     has been re-oriented to best fit its surface portions within the tolerance
     boxes with positive weighting factors and to avoid boxes with negative
     weighting factors as shown in FIG. 8B. Then the internal torsion angles of
     the rotatable bonds are altered to re-conform the molecule to again best
     fit the surface portions of the molecule within the modified boxes as
     shown in FIG. 8C. Molecule 3 is known to have low activity. As illustrated
     in FIG. 8C, the molecule cannot be maneuvered to fit into one of the
     tolerance boxes. This may cause the calculated predicted activity of
     molecule 3 to be low as well so that the model is confirmed. Molecule 4 is
     re-oriented and re-conformed in a manner similar to that for molecule 3.
     As shown in FIG. 9C, molecule 4 can be reposed so that its surface
     portions fit within all the tolerance boxes of the model. This may cause
     molecule 4 to have a high predicted activity, contrary to the known low
     activity of the molecule. If this happens, this may cause the error
     function to exceed the preset threshold(s) so that the parameter values
     would have to be modified again as described above for the inner loop in
     blocks 106, 108 and diamond 110.
<BR><BR>The above-described process makes good use of the salient feature of poses
     of inactive as well as active molecules. The above-described reposing
     process with aligned and conformed poses of active molecules to maximize
     the activities and to repose the inactive molecules to be in the best
     position to refute the model. Thus, in order for the model to pass the
     abovedescribed testing process, it will predict the inactivity of poses of
     inactive molecules even though these have been realigned and reconfirmed
     to be in the best position to "fool" the model, while at the same time
     confirming the activity of the active molecules.
<BR><BR>In the preferred embodiment, gradient search methods are also used for
     reposing the training molecules to maximize their predicted activities as
     functions of the orientation and conformational parameters.
<BR><BR>For both the point-based and ray-based feature extraction methods used in
     conjunction with either the van der Waals or Conholly surfaces, the
     extracted features are differentiable functions of the orientation and
     conformational parameters. Furthermore, the model (as represented by the
     equations above) is a differentiable function of the values of the
     extracted features. Hence, by applying the chain rule, it is possible to
     compute the gradient of the predicted activity with respect to the
     orientation and conformational parameters and apply gradient-based search
     to find poses that maximize predicted activity. However, other kinds of
     models and other methods of feature extraction may not satisfy this
     property, in which case other computational methods (e.g., simulated
     annealing, linear programming) could be applied to find poses that
     maximize predicted activity. It is understood that the scope of the
     invention includes all methods for finding such poses.
<BR><BR>Instead of reposing the molecules, it is possible to simply re-select the
     best poses from the original set of poses formed prior to the selection
     step in block 100. It is found, however, that reposing the molecules
     rather than re-selecting from existing poses greatly reduces the error of
     prediction as indicated in Table 1 below in regard to a musk model.
<BR><BR>The trained model and the ultimate parameter values may then be used to
     predict the activity of a new molecule with unknown activity (block 116).
     Thus, again, feature values are extracted from the poses of the molecule
     and the predicted activities of the poses are calculated to find the best
     pose with the highest activity. Thus, the model not only enables the user
     to predict the activity of the molecule not in the training set but also
     predict its best poses. Its feature values in comparison with the
     parameter values would indicate which surface portions have the desirable
     properties in regard to a chemical function and which surface portions
     have undesirable properties in regard to such function. This is
     illustrated in more detail in FIGS. 12A-12F and the accompanying
     description below. In fact, the model may be used to search a database of
     molecules with unknown activity and predict the activities of their poses.
     Poses of these molecules may be modified to alter their predicted
     activities.
<BR><BR>In FIG. 7 above, the model parameter values are optimized in an inner loop
     before the molecules are reposed or poses reselected in an outer loop.
     Such embodiment is efficient because reposing molecules requires large
     numbers of calculations. It will be understood, however, that the
     optimization can be performed in ways different from that described above
     and are within the scope of the invention. For example, it is possible to
     maximize the activity by reposing in an inner loop before the model
     parameter values are optimized to minimize the differences between
     predicted and actual activities of best poses in an outer loop. The two
     optimization processes may also be intertwined.
<BR><BR>In the above-described point based feature extraction using a van der Waals
     surface representation of atoms, it will be simpler not to have to first
     calculate the surface representations of the entire molecule but simply to
     determine the closest distance between a particular sampling point and
     find the atom whose van der Waals surface will be at the closest distance
     to such sampling point. In order to determine the nearest atomic surface
     to a sampling point, one way requires computing the distance between the
     sampling point and the van der Waals sphere computed for each atom in the
     molecule separately. For each atom in the molecule, the distance d between
     a sampling point p with coordinates (px, py, pz) and the van der Waals
     sphere of radius r for an atom with a center at c with coordinates (cx,
     cy, cz) is:
<BR><BR>d=sqrt((px-cx).sup.2 +(py-cy).sup.2 +(pz--cz).sup.2)-r
<BR><BR>This requires computing a square root, for each possible atom, which is
     very expensive. Another aspect of the invention provides a much more
     efficient way to compute this distance d, based on the observation that it
     is cheaper to compute the square of the distance than to compute the
     distance itself. The nearest-atom computation operates in two passes on
     each feature. In the first pass, we find the minimum distance squared to
     atomic centers. The atom with the minimum distance to atomic center is not
     necessarily the atom with the minimum distance to the van der Waals
     surface, however. Therefore, in the second pass, the distance to the van
     der Waals surface distance is determined only for atoms that are "close"
     to the minimum distance squared. It is noted here that the distance to the
     van der Waals surface distance cannot be computed in distance squared
     space, because of the subtraction of the van der Waals radius. In the
     second pass, "close" is computed in terms of the difference between the
     radius of the atom with the minimum distance squared to center and the
     maximum possible atomic radius.
<BR><BR>Specifically, in reference to FIG. 10, suppose the atom with the minimum
     distance squared to its center 130 has distance d' to the sampling point
     134 and radius r. Suppose the atom in the molecule centered at 132 with
     the maximum radius has radius r.sub.max. Then an atom center (e.g. 132) of
     another atom could in principle be up to d'+r.sub.max -r away and have the
     same distance to the van der Waals shell viewed from point 134 as the atom
     centered at 130. So we want to look at all atoms close to center 130 but
     whose distance squared to atomic center is within (d'+r.sub.max -r).sup.2
     away. Thus, in the second pass, we look at atoms in the vicinity of 130
     with van der Waals radii between r and r.sub.max using a square root
     calculation.
<BR><BR>EXAMPLE
<BR><BR>The relationship between the model parameter values and the poses of the
     molecules may be displayed visually using computer graphics to aid
     biochemical design as in the musk odor prediction problem described below.
     Thus, the parameter values .mu..sub.i, .sigma..sub.i and weighting factor
     v.sub.ji discussed above may be displayed on a screen of a monitor as well
     as a surface of a molecule. The model parameter values may be illustrated
     by octagonal patches near the surface of the molecule where each feature
     was measured. Each patch is colored according to whether the measurement
     found the surface to be too close, too far, or about right. These three
     values are computed by thresholding the Gaussian corresponding to each
     feature. Clearly, a Gaussian with a wide G will allow a broader range of
     distance measurements to count as "about right."
<BR><BR>When the surface is too far from the measurement point, there may be room
     to modify the molecule to add additional bulk to the molecule. When the
     surface is too close to the measurement point, there may be need to modify
     the molecule to trim bulk from the molecule.
<BR><BR>Thus, the pattern of colored patches may guide the medicinal chemist in
     choosing the parts of the molecule which should be made larger or smaller
     to improve the activity of the molecule.
<BR><BR>The problem of musk odor prediction has been the focus of many modeling
     efforts. Musk odor is a specific and clearly identifiable sensation,
     although the mechanisms underlying it are poorly understood. These
     molecules typically have a single hydrogen-bond acceptor on a roughly
     ellipsoidal hydrocarbon. Musk odor is determined almost entirely by steric
     effects. A single methyl group change can account for a significant change
     in musk odor.
<BR><BR>To test the invention's ability to predict subtle steric interactions, we
     studied a set of 102 diverse structures in several chemical classes
     collected from published studies. Only those compounds for which published
     assay values agreed were used. The data set contained 39 aromatic,
     oxygen-containing molecules with musk odor and 63 homologs that lacked
     musk odor. Each molecule was conformationally searched using a Monte Carlo
     procedure. Some molecules possessed flexible sidechains and exhibited a
     sizeable number of conformations (ranging from 2 to over 250), many of
     which significantly changed the overall shape of the molecule. Because all
     molecules were assayed as racemic mixtures, all stereoisomers of each
     molecule were likewise searched and included in the data set. The final
     dataset contained 6,953 conformathons of the 102 molecules.
<BR><BR><PRE>
                  TABLE 1
    ______________________________________
    Predictive accuracy of musk model in a 20-fold cross-validation
    hold-out test (standard error is in brackets).
              True False   True   False
              Pos. Neg.    Neg.   Pos.  % Correct
    ______________________________________
    Adaptive alignment
                36     3       57    6    91[2.8]
    Fixed alignment
                36     3       47   16    81[3.9]
    ______________________________________
</PRE>
<BR><BR>We performed a 20-fold cross-validation test of predictive performance. The
     molecules in the data set were partitioned into twenty random subsets.
     Twenty models were trained, with one of these subsets excluded from the
     training data during each execution. The model constructed in each
     execution was then tested to see how well it could predict the withheld
     molecules, and the results were totalled. Overall predictive performance
     using is 91% (see Table 1). In Table 1, "True Pos." means that a molecule
     which is active is confirmed to be active, "False Neg." means that an
     active molecule is erroneously predicted to be inactive, "True Neg." means
     that an inactive molecule is predicted to be inactive, and "False Pos."
     means that inactive molecules are erroneously predicted to be active. A
     model constructed using fixed molecular alignments results in predictive
     performance of 81%--the model-directed realignment (i.e., reposing) aspect
     of the invention substantially improves performance. The primary
     requirements of musk activity discovered by applying the invention are
     crudely illustrated in FIG. 11 (the actual learned models are sensitive to
     approximately fifty specific surface regions). Molecules must have a
     hydrogen bond acceptor at the appropriate geometry (positions 1 or 2), and
     the right amount of hydrophobic bulk at positions A, B and C. This model
     is consistent with other models of musk odor activity, but it was learned
     exclusively from a general surface-based representation of shape.
<BR><BR>Predictive models must be able to extrapolate beyond the structural classes
     analyzed during model generation to be useful for molecular design. Random
     hold-out tests, such as cross-validation, do not test this ability because
     they mix all structural classes in both the training and test data. To
     test extrapolation ability, we conducted a series of class-holdout
     experiments in which all molecules of a given structural class were
     withheld during training and then evaluated during testing. This simulates
     the situation in which chemists wish to apply a learned model to guide the
     synthesis of a new class of compounds. Table 2 shows four classes, the
     largest of which is class 2. Class 1 has a substantially different
     arrangement of hydrophobic bulk. Classes 2 and 4 have molecules with
     different hydrogen-bonding geometries. Each class represents a structural
     type that a chemist might choose as a synthetic target.
<BR><BR>Cross-class predictive performance ranges from 71% to 100% and in all cases
     benefit substantially by using adaptive alignment (i.e., iterative
     reposing and model parameter value modification)--the error-rate drops by
     more than half. A more useful criterion in assessing performance than
     percent correctly predicted above or below a fixed threshold is the
     quality of the ranking of the molecules as measured by the number of
     molecules that are misranked. The neural-network produces a value on the
     interval [0,1], and test molecules are ranked by this score. A ranked list
     is perfect if all active molecules are ranked higher than all inactive
     molecules. The number of misranked molecules is the minimum number of
     molecules that need to be eliminated from the ranked list to produce a
     list with a perfect ranking. This is different from other rank scores
     because the musk data contains only binary assay values but the invention
     makes real-valued predictions. By this measure, with adaptive alignment,
     predictive performance is very high, ranging from 86% to 100%. Performance
     on class 4 is the poorest and seems to be related to the non-planar
     geometry of the ether component of these molecules.
<BR><BR><PRE>
                                      TABLE 2
    __________________________________________________________________________
    Predictive accuracy of musk model across structural classes. Numbers in
    brackets
    are standard error. The counts reported in rows 2-4 are for adaptive
    alignment.
    Structural (1)4-substituted
                       (2)1- (3)6-substituted
    Class:     dihydroindanes
                       indanones
                             tetrahydronapthalenes
                                        (4) benzopyrans
    __________________________________________________________________________
    Number of molecules
                13      21    27         14
    True positives
                7       6     9          4
    False negatives
                0       0     4          3
    True negatives
                6       13    13         5
    False positives
                0       2     0          1
    Percent correct
               100[0.0]
                        90[6.5]
                              85[6.8]    71[12.1]
    (adaptive alignment)
    Percent correct
                85[9.9]
                        76[9.3]
                              74[8.4]    57[13.2]
    (fixed alignment)
    Number misranked
                0       1     1          2
    Percent correct
               100[0.0]
                        95[4.8]
                              96[3.8]    86[9.3]
    (by ranking)
    __________________________________________________________________________
</PRE>
<BR><BR>Previous studies of musk odor on similar molecules using atom-based
     approaches have produced similar levels of predictive accuracy in
     cross-validated predictive tests, ranging from 90% (std. err. 6.7) to 93%
     (std. err. 6.4). However, none of these studies has reported predictive
     results across chemical classes or has employed molecular properties that
     could easily be interpreted to guide design of new compounds.
<BR><BR>To illustrate the system's ability to provide detailed guidance in
     molecular design, additional models were trained while withholding
     specific pairs, triplets, and quadruplets of molecules that differed by
     single methyl group additions and deletions. FIG. 12A-12F depicts six
     molecules, each processed by a model. The molecules are displayed in their
     most active predicted poses (chosen by the model) with a Connolly surface.
     M. J. Connolly, J. Appl. Cryst., 16, 548 (1983). The patches on each
     surface correspond to the set of features selected by the model. The
     surface has an acceptable steric interaction if it has a gray patch at
     that location. White patches indicate areas that should be increased in
     size, and black patches indicate areas whose size should be decreased.
<BR><BR>The method's ability to provide detailed guidance in molecular design is
     demonstrated in FIGS. 12A-12F. Only black, gray and white patches are
     shown in these figures since color patches cannot be reproduced in patent
     drawings. FIGS. 12A-12D display four molecules in their predicted poses as
     chosen by a model trained on the remaining ninety-eight molecules. Each
     molecule is displayed as a Connolly surface. The relative musk odor
     strength of these four hold-out molecules is known. The patches on each
     surface correspond to the features selected by the model during training.
     The surface has a good steric interaction if it has a gray patch at that
     location. White patches indicate areas that should be increased in size,
     and black patches indicate areas whose size should be decreased. FIG. 12A
     displays a correctly predicted inactive molecule, and the white patches
     suggest that activity could be increased by adding bulk near the arrow
     (corresponding to area A in FIG. 11). FIG. 12B shows the molecule
     resulting from the addition of a methyl group at this point, correctly
     predicted to have musk odor. From this molecule, which has only moderate
     musk odor intensity, the indicated region (corresponding to area B of FIG.
     11) is predicted to benefit from additional bulk. Either adding a methyl
     group to the aromatic ring, shown in FIG. 12C, or changing the methyl
     group added to FIG. 12A to an ethyl, achieves this result. Both the
     molecules in FIGS. 12C, 12D have greater musk odor than molecule in FIG.
     12B, as predicted.
<BR><BR>FIGS. 12E, 12F show the application of another model, constructed by
     withholding the pair of molecules shown. FIG. 12A, the black patches
     suggest an unfavorable interaction (indicated by the arrow). This can be
     directly remedied by removal of the corresponding methyl group. The result
     is a correctly predicted molecule with strong musk odor, shown in FIG.
     12B. Another approach is to remove the methyl substituent on the aromatic
     ring that is responsible for the ketone's unfavorable orientation. This
     results in a molecule of medium musk strength (not shown). Several other
     examples of guided design on molecules from different structural classes
     in this data set were observed.
<BR><BR>What follows is a detailed description of predictive model generation from
     a set of molecules and assay values. We first discussed the surface
     representation, then the neural-network learning algorithm, then the
     adaptive alignment procedure. Consider a molecule in a particular
     conformation at a particular location and orientation in space. This
     situation is defined by the internal torsion angles of the rotatable
     bonds, and the three rigid rotations and translations. This mathematically
     defines the pose of the molecule. From each pose p of a molecule m, we
     generate a high-dimensional vector of features V(m,p) for purposes of
     activity prediction. Each element of the feature vector characterizes a
     portion of the smoothed van der Wall's surface of the molecule.
<BR><BR>Our goal is to predict the activity of a molecule as a function of the
     feature vector. However, because there are infinitely many poses of
     molecule, there are infinitely many feature vectors. Let A(V(m,p) denote
     the predicted activity of molecule m in pose p. The predicted activity for
     m is defined to be the maximum of these predictions over all possible (low
     energy) poses: Max.sub.low energy p A(V(m,p)). In chemical terms, this is
     analogous to permitting the molecule to rotate, translate and alter its
     conformation to achieve the best possible fit to the binding site.
<BR><BR>To achieve this maximization, we conduct a conformational search for each
     molecule to identify its low-energy conformations. Each of these
     conformers is placed in a starting pose, and the learning algorithm is
     applied to construct a model A(V(m,p)). For the application reported here,
     initial poses were chosen such that their aromatic rings were tightly
     aligned and their oxygens were properly positioned to form a hydrogen bond
     with an assumed H-bond donor atom (34, 35). This produced an acceptable
     coarse alignment of the molecules. The model computes a weighted sum of
     non-linear functions, which can be cascaded, whose parameters can be
     estimated to achieve a mapping from input molecular features to an output
     activity value. The activity of musks was encoded as 0.982 and the
     activity of non-musks was encoded as 0.018. A molecule was predicted to be
     a musk if the model computed its activity to be greater than 0.5. Such
     models are called neural networks because of the analogy to biological
     neural networks where the "neurons" compute non-linear functions based on
     weighted and summed input ("synaptic connections") from other neurons. Our
     model is of the form:
     ##EQU4##
     where F, G are non-linear functions. The vectors v.sub.j, j=0 . . . m and
     w.sub.k, k=l . . . n are vectors of adjustable weights. The set P is the
     set of poses generated thus far. The model is trained by an iterative
     weight adjustment procedure that seeks to minimize error using
     gradient-based search, called error back-propagation. D. E. Rumelhart, G.
     E. Hinton, R. J. Williams, in "Parallel Distributed Processing:
     Explorations in the Microstructure of Cognition," D. E. Rumelhart, J. L.
     McClelland, and the PDP Research Group, Eds. (MIT Press/Bradford,
     Cambridge, Mass. 1986), Vol. 1: Foundations. For each molecule, only the
     pose giving the highest predicted activity (using the current model) is
     used to update the weight vectors.
<BR><BR>In each iteration, after the neural network model has been trained, it is
     applied to each molecule m.sub.i to find the pose p.sub.i that maximizes
     the predicted activity of m.sub.i by performing rigid rotations and
     translations. This is accomplished by computing the gradient of the
     predicted activity with respect to the pose and employing gradient search
     methods. The poses computed in this fashion for the active molecules are
     precisely those poses that serve to confirm the model--they cause the
     active molecules to align more tightly with each other along those
     portions of the molecular surface that are important for activity
     prediction. The poses computed for inactive molecules are precisely those
     poses that best refute the model. Hence, we see that this algorithm
     applies a simple form of the scientific method of conjecture and
     refutation until a model is found that cannot be refuted. To attain
     convergence, at most five iterations of model-building and pose generation
     were required. The advantage of this approach is that only a small
     fraction of the infinite space of possible poses needs to be explicitly
     considered, and yet the resulting model is robust with respect to a much
     wider range of poses of the molecules. It also makes good use of negative
     data.
<BR><BR>This adaptive approach to posing molecules is a major departure from
     previous methods. Any method that attempts to measure subtle shape
     differences among molecules must measure molecular properties (e.g.,
     interatomic distances, occupancy of binding sites) that vary with pose.
     Previous methods assume that the correct poses of molecules can be
     selected before a predictive model is constructed. Models constructed from
     standard fixed poses may not give accurate predictions for new molecules.
     New molecules must be placed in the appropriate pose based on intuition or
     ad hoc procedures that may behave poorly, especially with molecules from
     novel structural classes. Our approach, in contrast, uses the constructed
     model to guide the generation of the correct poses, so that molecules are
     aligned along those surface regions that are most predictive of activity
     differences.
<BR><BR>We have demonstrated a new method for activity prediction and molecular
     design using a surface-based representation of molecular shape that
     exhibits high predictivity and extrapolates well across structural
     classes. Automatic selection of conformations and adaptive alignment of
     molecules was shown to substantially improve predictive performance.
     Three-dimensional visualization of models guided structural changes of
     molecules that enhanced biological activity. The surface-based molecular
     representation yielded excellent cross-class predictive performance, a
     capability which is critical for advancing drug design into new structural
     classes. The model was able to resolve the effects of very subtle surface
     changes.
<BR><BR>Where the known activities of the molecules are expressed in quantitative
     terms, the above-described model can be readily applied using the
     quantitative known activities. Where the activities are non-numerical,
     such as in the musk study above, musk strength prediction is somewhat
     complicated. The reported strengths are discrete non-numerical values; for
     example, "extremely strong" and "fairly weak." There are about ten such
     values. How do we map "medium strength" to a number?
<BR><BR>We could use an arbitrary mapping, like "odorless" is 0.1 and "very weak"
     is 0.2 and "weak" is 0.3, and so on. But there is a potential problem.
     There is, in some sense, a "right" answer. Assuming no hidden units, the
     output is essentially a linear sum of the feature inputs. There may not be
     any linear weighting that gets very close to an arbitrary assignment of
     numbers to strengths. The curve is kinked. The system will devote a lot of
     effort to trying to unkink it.
<BR><BR>As an alternative, we let the system figure out what the true assignment of
     discrete categories to numerical values is. The target value for each
     category is initialized arbitrarily, with correct ordering, as above. But
     then it can float. We backpropagate the error term for each category into
     the target value for the category. So, during training, we periodically
     look at the output of the model for all the "medium" musks and take the
     average, say 0.56. Then we adjust the target for "medium" molecules from
     its current value (say 0.52) in the direction of the average. This reduces
     the error for all the medium molecules (since the error is computed as the
     difference between the actual and target values).
<BR><BR>The learning rate parameter for this backpropagation has to be set low, so
     that the system does not thrash trying to fix gross errors in the model by
     adjusting the target values.
<BR><BR>It may be necessary to permanently wire the extreme values ("odorless" and
     "extremely strong") to 0.1 and 0.9 to avoid having the system reduce error
     by collapsing the scale.
<BR><BR>It is possible that for various reasons (e.g., bad assays), even with a low
     learning rate the targets could cross (so that, e.g., "medium" got to be
     higher than "fairly strong"). We could fix this by adding a 1/r.sup.2
     "repulsive force" to the targets, so that in the target update phase as
     two targets got close to each other, they would be held apart. (This would
     also have the side effect of preventing scale collapse.)
<BR><BR>This level of indirection between the reported assay values and the
     system's target values can also be used to make assay values reported from
     different sources commensurable. This applies to both numerical and
     non-numerical assays. Commonly, one paper in the literature will report
     assay values for one set of molecules and another paper will report assay
     values for another set. Particularly, if the sets are disjoint, these
     values may not be commensurable, since the assays typically were performed
     under somewhat different conditions. Now, we have the correct ordering for
     the assay values on a per-source basis (and also the within-source
     relative magnitudes, in the case of numerical data). The target-score
     adjustment code will respect that, but between papers, one can let the
     system do as it pleases and decide, for example, that one paper is 0.05 is
     equivalent to other's 2.7.
<BR><BR>Generality of the Invention
<BR><BR>Two aspects of the invention described above, the method of iterative
     reposing objects to produce better models and the method of training a
     model when each object has multiple representations, are applicable not
     only to biological activity modeling but also to many other problems
     including handwriting recognition. We illustrate this with the task of
     handwritten character recognition.
<BR><BR>Computer methods for automatically recognizing handwritten characters would
     be extremely useful in several fields including the reading of zip codes
     on envelopes, dollar amounts on personal checks, and handwritten
     characters on pen-based computers. An accepted way of representing
     handwritten letters for automated recognition is to take a digital picture
     of each letter. The picture represented in the computer by, for example, a
     16.times.16 grid of binary values (a part of which is shown in FIG. 13).
     These two hundred fifty-six values become the features that can be input
     into a general purpose classification algorithm, such as a neural network.
     As with the molecules discussed above, each character can be defined to
     have a "pose." For example, a character can rotate or translate in two
     dimensions as well as be scaled larger or smaller. The pose of a character
     can be defined by a set of parameters (e.g., two rotational parameters,
     two translational parameters, and one scale parameter).
<BR><BR>Let us first consider how the general machine learning method of learning
     from multiple representations could be applied to this task. Suppose we
     wish to automatically recognize instances of the letter `A.` A training
     set could be constructed consisting of a large number of digitized
     handwritten `A`s as well as a large number of other characters and symbols
     from which the `A`s need to be discriminated. Then the general procedure
     shown in FIG. 14 could be applied.
<BR><BR>First (block 200), a neural network model for `A` could be initialized.
     Each of the N different characters and symbols forms a training object.
     Then (block 202), for each object in the training set, a set of poses
     could be generated by computing several different combinations of
     rotations, translations, and scalings of each character (set 1, . . . ,
     set N). Features (e.g. 256 values in a 16 by 16 grid) would be extracted
     (block 204) and then the neural network model would be applied to predict
     whether each of the representative poses was an instance of the letter `A`
     (block 206). Based on the predicted scores, one or more best
     representative poses of each object in the training set would be selected,
     and the neural network model would be trained to predict correctly whether
     each pose was an instance of the letter `A..degree. If the model and the
     choices of best representations do not change substantially from previous
     iterations (block 21), then the process terminates. Otherwise, the current
     model is applied to all of the poses of each object in the training set
     (block 206) to again select one or more best representations for each
     object.
<BR><BR>Once the model and the choice of representations converges, the learned
     model can be applied to predict whether or not new objects are instances
     of the letter `A` (block 212). The same procedure could be applied to
     construct recognizers for each of the other letters of the alphabet, the
     digits, punctuation symbols, and so on.
<BR><BR>Now that we have described how the general machine learning method could be
     applied to character recognition, let us consider how the method of
     dynamic reposing (not shown in FIG. 14) could also be applied to this
     problem. The method is exactly analogous to FIG. 7. As above, we begin
     with a training set consisting of a large number of digitized handwritten
     `A`s as well as a large number of other characters and symbols from which
     the `A`s need to be discriminated. Rather than generating many different
     poses of each character, we would compute initial poses by rotating,
     translating, and scaling the characters in the training set so that they
     all had approximately the same orientation and size. This corresponds to
     block 100 of FIG. 7. Then a neural network training procedure is carried
     out (blocks 108, 110). After training the model, the key component of this
     aspect of the invention would be applied. The current trained model would
     be used to guide the reposing of each of the training set characters
     (block 112) in an attempt to maximize the predicted output of the neural
     network (i.e., to maximize the likelihood that the network would predict
     that each character was an `A`). The resulting poses would then be used as
     input for another iteration of retraining the model. This process would be
     repeated until the model and the poses ceased to change significantly.
<BR><BR>To apply the learned model to determine whether a new character is an
     instance of the letter `A` (block 16), the new character would be reposed
     to maximize the predicted output of the neural network. If this predicted
     output exceeded a preset threshold, the character would be classified as
     an `A,` otherwise it would be not be classified as an `A.` If several
     models had been learned (e.g., one for each letter), then the new
     character would be reposed separately for each model, and the model that
     gave the highest predicted output would be applied to classify the new
     character.
<BR><BR>As with molecules, the advantage of this aspect of the invention over prior
     methods is that rather than attempting to classify the characters in their
     starting poses (which are somewhat arbitrary), the invention reposes the
     characters so that they adopt poses most informative for recognition
     (i.e., poses that accentuate those aspects of the letter `A` that are
     shared among all instances of `A`s and not shared by instances of other
     characters).
<BR><BR>It will be understood that these two aspects of the invention do not
     require that a neural network learning procedure be employed. They can be
     applied with any procedure that constructs predictive models. It will also
     be understood that these two aspects of the invention are not limited to
     problems of assigning objects into a discrete set of classes (e.g., active
     vs. inactive, `A` vs. `B` vs. `C` etc.). The methods can also be applied
     to tasks, such as drug activity prediction, in which the model must
     predict a real-valued property of the objects.
<BR><BR>The invention has been described by reference to various embodiments. It
     will be understood that various modifications and changes may be made
     without departing from the scope of the invention which is to be limited
     only by the appended claims.
<BR><BR><CENTER><B>* * * * *</B></CENTER>
<HR>
</BODY>
</HTML>
